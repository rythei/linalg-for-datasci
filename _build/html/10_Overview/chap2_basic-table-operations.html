
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>2.2. Data Frames and Set Operations &#8212; Linear Algebra for Data Workbook</title>
    
  <link rel="stylesheet" href="../_static/css/index.f658d18f9b420779cfdf24aa0a7e2d77.css">

    
  <link rel="stylesheet"
    href="../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      
  <link rel="stylesheet"
    href="../_static/vendor/open-sans_all/1.44.1/index.css">
  <link rel="stylesheet"
    href="../_static/vendor/lato_latin-ext/1.44.1/index.css">

    
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../_static/sphinx-book-theme.40e2e510f6b7d1648584402491bb10fe.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="../_static/js/index.d3f166471bb80abb5163.js">

    <script id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/togglebutton.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script >var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../_static/sphinx-book-theme.d31b09fe5c1d09cb49b26a786de4a05d.js"></script>
    <script async="async" src="https://unpkg.com/thebelab@latest/lib/index.js"></script>
    <script >
        const thebe_selector = ".thebe"
        const thebe_selector_input = "pre"
        const thebe_selector_output = ".output"
    </script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["\\(", "\\)"]], "displayMath": [["\\[", "\\]"]], "processRefs": false, "processEnvironments": false}})</script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="2.3. Homework 1" href="hw01.html" />
    <link rel="prev" title="2.1. Sets and Set Algebra" href="chap2_sets.html" />

    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="en" />



  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
<a class="navbar-brand text-wrap" href="../index.html">
  
  <img src="../_static/logo.png" class="logo" alt="logo">
  
  
  <h1 class="site-logo" id="site-title">Linear Algebra for Data Workbook</h1>
  
</a>
</div><form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form>
<nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">
    <ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="../overview.html">
   Welcome to Stat 89A
  </a>
 </li>
</ul>
<p class="caption collapsible-parent">
 <span class="caption-text">
  Background
 </span>
</p>
<ul class="nav sidenav_l1">
 <li class="toctree-l1 collapsible-parent">
  <a class="reference internal" href="../00_Background/python_overview.html">
   1. (CH0): Python 101
  </a>
  <ul class="collapse-ul">
   <li class="toctree-l2">
    <a class="reference internal" href="../00_Background/basics.html">
     1.1. The Basics
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../00_Background/numpy.html">
     1.2. NumPy
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../00_Background/plotting.html">
     1.3. MatPlotLib
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../00_Background/playground0.html">
     1.4. Play Ground
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../00_Background/hw0.html">
     1.5. Homework 0: Due Sunday January 24, 2021, 11:59 PM CA time
    </a>
   </li>
  </ul>
  <i class="fas fa-chevron-down">
  </i>
 </li>
</ul>
<p class="caption collapsible-parent">
 <span class="caption-text">
  Introduction and Overview
 </span>
</p>
<ul class="current nav sidenav_l1">
 <li class="toctree-l1 collapsible-parent">
  <a class="reference internal" href="chap1_introduction_header.html">
   1. (CH1): Introduction and Overview
  </a>
  <ul class="collapse-ul">
   <li class="toctree-l2">
    <a class="reference internal" href="chap1_overview.html">
     1.1. Linear Algebra for Data
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="chap1_examples.html">
     1.2. Examples
    </a>
   </li>
  </ul>
  <i class="fas fa-chevron-down">
  </i>
 </li>
 <li class="toctree-l1 current active collapsible-parent">
  <a class="reference internal" href="chap2_algebras_header.html">
   2. (CH2): Algebra, algebras, and functions
  </a>
  <ul class="current collapse-ul">
   <li class="toctree-l2">
    <a class="reference internal" href="chap2_sets.html">
     2.1. Sets and Set Algebra
    </a>
   </li>
   <li class="toctree-l2 current active">
    <a class="current reference internal" href="#">
     2.2. Data Frames and Set Operations
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="hw01.html">
     2.3. Homework 1
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="chap2_functions-and-compositions.html">
     2.4. Functions and Compositions
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="hw02.html">
     2.5. Homework 2
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="chap2_injective-functions-and-left-inverses.html">
     2.6. Injective Functions and Left Inverses
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="chap2_surjective-functions-and-right-inverses.html">
     2.7. Surjective Functions and Right Inverses
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="chap2_generalized-inverses.html">
     2.8. Generalized inverses
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="hw03.html">
     2.9. Homework 3
    </a>
   </li>
  </ul>
  <i class="fas fa-chevron-down">
  </i>
 </li>
</ul>

</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="row topbar fixed-top container-xl">
    <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show">
    </div>
    <div class="col pl-2 topbar-main">
        
        <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
            data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
            aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
            title="Toggle navigation" data-toggle="tooltip" data-placement="left">
            <i class="fas fa-bars"></i>
            <i class="fas fa-arrow-left"></i>
            <i class="fas fa-arrow-up"></i>
        </button>
        
        
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        <a class="dropdown-buttons"
            href="../_sources/10_Overview/chap2_basic-table-operations.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download notebook file" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="../_sources/10_Overview/chap2_basic-table-operations.md"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.md</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
            onClick="window.print()" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

        <!-- Source interaction buttons -->


        <!-- Full screen (wrap in <a> to have style consistency -->
        <a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
                data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
                title="Fullscreen mode"><i
                    class="fas fa-expand"></i></button></a>

        <!-- Launch buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Launch interactive content"><i class="fas fa-rocket"></i></button>
    <div class="dropdown-buttons">
        
        <a class="binder-button" href="https://mybinder.org/v2/gh/erichson/LinearAlgebra/master?urlpath=tree/10_Overview/chap2_basic-table-operations.md"><button type="button"
                class="btn btn-secondary topbarbtn" title="Launch Binder" data-toggle="tooltip"
                data-placement="left"><img class="binder-button-logo"
                    src="../_static/images/logo_binder.svg"
                    alt="Interact on binder">Binder</button></a>
        
        
        
        
    </div>
</div>

    </div>

    <!-- Table of contents -->
    <div class="d-none d-md-block col-md-2 bd-toc show">
        
        <div class="tocsection onthispage pt-5 pb-3">
            <i class="fas fa-list"></i> Contents
        </div>
        <nav id="bd-toc-nav">
            <ul class="nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#basic-properties-of-a-data-frame">
   2.2.1. Basic properties of a data frame
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#select-and-group-by">
   2.2.2. Select and group by
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#merge-and-set-operations">
   2.2.3. Merge and set operations
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#set-complements-with-data-frames">
   2.2.4. Set complements (with data frames)
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#set-associativity-with-data-frames">
   2.2.5. Set associativity (with data frames)
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#set-distributivity-with-data-frames">
   2.2.6. Set distributivity (with data frames)
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#set-idempotence-with-data-frames">
   2.2.7. Set idempotence (with data frames)
  </a>
 </li>
</ul>

        </nav>
        
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
        
              <div>
                
  <div class="section" id="data-frames-and-set-operations">
<h1><span class="section-number">2.2. </span>Data Frames and Set Operations<a class="headerlink" href="#data-frames-and-set-operations" title="Permalink to this headline">¶</a></h1>
<p>In this section, we will introduce data frames.  Topics to be covered include the following.</p>
<ul class="simple">
<li><p>Introduce basic properties of data frames.</p></li>
<li><p>Show that many operations on data frames can be viewed as set operations, including how the union and intersection operations which we performed on sets correspond to outer and inner joins on data frames.</p></li>
<li><p>Illustrate simple properties from the algebra of sets in data frames.</p></li>
</ul>
<p>Let’s start by considering rosters from three (fictional) statistics classes.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">from</span> <span class="nn">datasets</span> <span class="k">import</span> <span class="n">students</span>
<span class="n">students</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">FileNotFoundError</span><span class="g g-Whitespace">                         </span>Traceback (most recent call last)
<span class="o">&lt;</span><span class="n">ipython</span><span class="o">-</span><span class="nb">input</span><span class="o">-</span><span class="mi">1</span><span class="o">-</span><span class="n">fd87cfdbbe28</span><span class="o">&gt;</span> <span class="ow">in</span> <span class="o">&lt;</span><span class="n">module</span><span class="o">&gt;</span>
<span class="g g-Whitespace">      </span><span class="mi">1</span> <span class="kn">import</span> <span class="nn">pandas</span> <span class="kn">as</span> <span class="nn">pd</span>
<span class="ne">----&gt; </span><span class="mi">2</span> <span class="kn">from</span> <span class="nn">datasets</span> <span class="kn">import</span> <span class="n">students</span>
<span class="g g-Whitespace">      </span><span class="mi">3</span> <span class="n">students</span>

<span class="o">/</span><span class="n">Volumes</span><span class="o">/</span><span class="n">GoogleDrive</span><span class="o">-</span><span class="mi">112349428810515690974</span><span class="o">/</span><span class="n">My</span> <span class="n">Drive</span><span class="o">/</span><span class="n">PhD</span><span class="o">/</span><span class="n">Teaching</span><span class="o">/</span><span class="n">Stat89A_Spring2022</span><span class="o">/</span><span class="n">linalg</span><span class="o">-</span><span class="k">for</span><span class="o">-</span><span class="n">datasci</span><span class="o">/</span><span class="mi">10</span><span class="n">_Overview</span><span class="o">/</span><span class="n">datasets</span><span class="o">.</span><span class="n">py</span> <span class="ow">in</span> <span class="o">&lt;</span><span class="n">module</span><span class="o">&gt;</span>
<span class="g g-Whitespace">      </span><span class="mi">5</span> <span class="n">HERE</span> <span class="o">=</span> <span class="s2">&quot;../datasets/&quot;</span>
<span class="g g-Whitespace">      </span><span class="mi">6</span> 
<span class="ne">----&gt; </span><span class="mi">7</span> <span class="n">circuit_courts</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">HERE</span><span class="p">,</span> <span class="s2">&quot;circuit_courts.csv&quot;</span><span class="p">))</span>
<span class="g g-Whitespace">      </span><span class="mi">8</span> 
<span class="g g-Whitespace">      </span><span class="mi">9</span> <span class="n">discretized_functions</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">HERE</span><span class="p">,</span> <span class="s2">&quot;discretized_functions.csv&quot;</span><span class="p">))</span>

<span class="nn">/usr/local/lib/python3.7/site-packages/pandas/io/parsers.py</span> in <span class="ni">read_csv</span><span class="nt">(filepath_or_buffer, sep, delimiter, header, names, index_col, usecols, squeeze, prefix, mangle_dupe_cols, dtype, engine, converters, true_values, false_values, skipinitialspace, skiprows, skipfooter, nrows, na_values, keep_default_na, na_filter, verbose, skip_blank_lines, parse_dates, infer_datetime_format, keep_date_col, date_parser, dayfirst, cache_dates, iterator, chunksize, compression, thousands, decimal, lineterminator, quotechar, quoting, doublequote, escapechar, comment, encoding, dialect, error_bad_lines, warn_bad_lines, delim_whitespace, low_memory, memory_map, float_precision, storage_options)</span>
<span class="g g-Whitespace">    </span><span class="mi">603</span>     <span class="n">kwds</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">kwds_defaults</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">604</span> 
<span class="ne">--&gt; </span><span class="mi">605</span>     <span class="k">return</span> <span class="n">_read</span><span class="p">(</span><span class="n">filepath_or_buffer</span><span class="p">,</span> <span class="n">kwds</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">606</span> 
<span class="g g-Whitespace">    </span><span class="mi">607</span> 

<span class="nn">/usr/local/lib/python3.7/site-packages/pandas/io/parsers.py</span> in <span class="ni">_read</span><span class="nt">(filepath_or_buffer, kwds)</span>
<span class="g g-Whitespace">    </span><span class="mi">455</span> 
<span class="g g-Whitespace">    </span><span class="mi">456</span>     <span class="c1"># Create the parser.</span>
<span class="ne">--&gt; </span><span class="mi">457</span>     <span class="n">parser</span> <span class="o">=</span> <span class="n">TextFileReader</span><span class="p">(</span><span class="n">filepath_or_buffer</span><span class="p">,</span> <span class="o">**</span><span class="n">kwds</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">458</span> 
<span class="g g-Whitespace">    </span><span class="mi">459</span>     <span class="k">if</span> <span class="n">chunksize</span> <span class="ow">or</span> <span class="n">iterator</span><span class="p">:</span>

<span class="nn">/usr/local/lib/python3.7/site-packages/pandas/io/parsers.py</span> in <span class="ni">__init__</span><span class="nt">(self, f, engine, **kwds)</span>
<span class="g g-Whitespace">    </span><span class="mi">812</span>             <span class="bp">self</span><span class="o">.</span><span class="n">options</span><span class="p">[</span><span class="s2">&quot;has_index_names&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">kwds</span><span class="p">[</span><span class="s2">&quot;has_index_names&quot;</span><span class="p">]</span>
<span class="g g-Whitespace">    </span><span class="mi">813</span> 
<span class="ne">--&gt; </span><span class="mi">814</span>         <span class="bp">self</span><span class="o">.</span><span class="n">_engine</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_make_engine</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">engine</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">815</span> 
<span class="g g-Whitespace">    </span><span class="mi">816</span>     <span class="k">def</span> <span class="nf">close</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>

<span class="nn">/usr/local/lib/python3.7/site-packages/pandas/io/parsers.py</span> in <span class="ni">_make_engine</span><span class="nt">(self, engine)</span>
<span class="g g-Whitespace">   </span><span class="mi">1043</span>             <span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">1044</span>         <span class="c1"># error: Too many arguments for &quot;ParserBase&quot;</span>
<span class="ne">-&gt; </span><span class="mi">1045</span>         <span class="k">return</span> <span class="n">mapping</span><span class="p">[</span><span class="n">engine</span><span class="p">](</span><span class="bp">self</span><span class="o">.</span><span class="n">f</span><span class="p">,</span> <span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">options</span><span class="p">)</span>  <span class="c1"># type: ignore[call-arg]</span>
<span class="g g-Whitespace">   </span><span class="mi">1046</span> 
<span class="g g-Whitespace">   </span><span class="mi">1047</span>     <span class="k">def</span> <span class="nf">_failover_to_python</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>

<span class="nn">/usr/local/lib/python3.7/site-packages/pandas/io/parsers.py</span> in <span class="ni">__init__</span><span class="nt">(self, src, **kwds)</span>
<span class="g g-Whitespace">   </span><span class="mi">1860</span> 
<span class="g g-Whitespace">   </span><span class="mi">1861</span>         <span class="c1"># open handles</span>
<span class="ne">-&gt; </span><span class="mi">1862</span>         <span class="bp">self</span><span class="o">.</span><span class="n">_open_handles</span><span class="p">(</span><span class="n">src</span><span class="p">,</span> <span class="n">kwds</span><span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">1863</span>         <span class="k">assert</span> <span class="bp">self</span><span class="o">.</span><span class="n">handles</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span>
<span class="g g-Whitespace">   </span><span class="mi">1864</span>         <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="p">(</span><span class="s2">&quot;storage_options&quot;</span><span class="p">,</span> <span class="s2">&quot;encoding&quot;</span><span class="p">,</span> <span class="s2">&quot;memory_map&quot;</span><span class="p">,</span> <span class="s2">&quot;compression&quot;</span><span class="p">):</span>

<span class="nn">/usr/local/lib/python3.7/site-packages/pandas/io/parsers.py</span> in <span class="ni">_open_handles</span><span class="nt">(self, src, kwds)</span>
<span class="g g-Whitespace">   </span><span class="mi">1361</span>             <span class="n">compression</span><span class="o">=</span><span class="n">kwds</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;compression&quot;</span><span class="p">,</span> <span class="bp">None</span><span class="p">),</span>
<span class="g g-Whitespace">   </span><span class="mi">1362</span>             <span class="n">memory_map</span><span class="o">=</span><span class="n">kwds</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;memory_map&quot;</span><span class="p">,</span> <span class="bp">False</span><span class="p">),</span>
<span class="ne">-&gt; </span><span class="mi">1363</span>             <span class="n">storage_options</span><span class="o">=</span><span class="n">kwds</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;storage_options&quot;</span><span class="p">,</span> <span class="bp">None</span><span class="p">),</span>
<span class="g g-Whitespace">   </span><span class="mi">1364</span>         <span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">1365</span> 

<span class="nn">/usr/local/lib/python3.7/site-packages/pandas/io/common.py</span> in <span class="ni">get_handle</span><span class="nt">(path_or_buf, mode, encoding, compression, memory_map, is_text, errors, storage_options)</span>
<span class="g g-Whitespace">    </span><span class="mi">642</span>                 <span class="n">encoding</span><span class="o">=</span><span class="n">ioargs</span><span class="o">.</span><span class="n">encoding</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">643</span>                 <span class="n">errors</span><span class="o">=</span><span class="n">errors</span><span class="p">,</span>
<span class="ne">--&gt; </span><span class="mi">644</span>                 <span class="n">newline</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">645</span>             <span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">646</span>         <span class="k">else</span><span class="p">:</span>

<span class="ne">FileNotFoundError</span>: [Errno 2] No such file or directory: &#39;../datasets/circuit_courts.csv&#39;
</pre></div>
</div>
</div>
</div>
<div class="section" id="basic-properties-of-a-data-frame">
<h2><span class="section-number">2.2.1. </span>Basic properties of a data frame<a class="headerlink" href="#basic-properties-of-a-data-frame" title="Permalink to this headline">¶</a></h2>
<p>If the data frame is small, we can just print it out and look at the entire thing. However, it is often too big to do this, in which case we want to figure out basic properties of the data frame. Here are examples of how to do this.</p>
<p>We can determine the shape (number of rows and columns) of a data frame using the <code class="docutils literal notranslate"><span class="pre">.shape</span></code> command:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">students</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">NameError</span><span class="g g-Whitespace">                                 </span>Traceback (most recent call last)
<span class="o">&lt;</span><span class="n">ipython</span><span class="o">-</span><span class="nb">input</span><span class="o">-</span><span class="mi">2</span><span class="o">-</span><span class="mi">1</span><span class="n">ae63f913424</span><span class="o">&gt;</span> <span class="ow">in</span> <span class="o">&lt;</span><span class="n">module</span><span class="o">&gt;</span>
<span class="ne">----&gt; </span><span class="mi">1</span> <span class="n">students</span><span class="o">.</span><span class="n">shape</span>

<span class="ne">NameError</span>: name &#39;students&#39; is not defined
</pre></div>
</div>
</div>
</div>
<p>Here, we see that the <code class="docutils literal notranslate"><span class="pre">students</span></code> data frame has 41 rows and 5 columns.</p>
<p>In many cases, the columns of a data frame will have meaningful names. We can inspect these names using the <code class="docutils literal notranslate"><span class="pre">.columns</span></code> command:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">students</span><span class="o">.</span><span class="n">columns</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">NameError</span><span class="g g-Whitespace">                                 </span>Traceback (most recent call last)
<span class="o">&lt;</span><span class="n">ipython</span><span class="o">-</span><span class="nb">input</span><span class="o">-</span><span class="mi">3</span><span class="o">-</span><span class="n">cc6d9b45cc1d</span><span class="o">&gt;</span> <span class="ow">in</span> <span class="o">&lt;</span><span class="n">module</span><span class="o">&gt;</span>
<span class="ne">----&gt; </span><span class="mi">1</span> <span class="n">students</span><span class="o">.</span><span class="n">columns</span>

<span class="ne">NameError</span>: name &#39;students&#39; is not defined
</pre></div>
</div>
</div>
</div>
<p>We can also inspect the first few rows of a data frame by using the <code class="docutils literal notranslate"><span class="pre">.head()</span></code> command:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">students</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">NameError</span><span class="g g-Whitespace">                                 </span>Traceback (most recent call last)
<span class="o">&lt;</span><span class="n">ipython</span><span class="o">-</span><span class="nb">input</span><span class="o">-</span><span class="mi">4</span><span class="o">-</span><span class="mi">29959</span><span class="n">f1cb694</span><span class="o">&gt;</span> <span class="ow">in</span> <span class="o">&lt;</span><span class="n">module</span><span class="o">&gt;</span>
<span class="ne">----&gt; </span><span class="mi">1</span> <span class="n">students</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>

<span class="ne">NameError</span>: name &#39;students&#39; is not defined
</pre></div>
</div>
</div>
</div>
<p>Alternatively, we can also inspect the last few rows of a data frame by using the <code class="docutils literal notranslate"><span class="pre">.tail()</span></code> command:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">students</span><span class="o">.</span><span class="n">tail</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">NameError</span><span class="g g-Whitespace">                                 </span>Traceback (most recent call last)
<span class="o">&lt;</span><span class="n">ipython</span><span class="o">-</span><span class="nb">input</span><span class="o">-</span><span class="mi">5</span><span class="o">-</span><span class="mi">5</span><span class="n">ffa3888d501</span><span class="o">&gt;</span> <span class="ow">in</span> <span class="o">&lt;</span><span class="n">module</span><span class="o">&gt;</span>
<span class="ne">----&gt; </span><span class="mi">1</span> <span class="n">students</span><span class="o">.</span><span class="n">tail</span><span class="p">()</span>

<span class="ne">NameError</span>: name &#39;students&#39; is not defined
</pre></div>
</div>
</div>
</div>
<p>If we want to access a particular column of a data frame, we can do so using brackets <code class="docutils literal notranslate"><span class="pre">[]</span></code> and the column name of interest. (Note: we can also select a single column using the command <code class="docutils literal notranslate"><span class="pre">students['Major']</span></code>, however, this will not return a data frame back, but another object called a Series. We use the double brackets to make sure we get a data frame, which is easier to work with.)</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">students</span><span class="p">[[</span><span class="s1">&#39;Major&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">NameError</span><span class="g g-Whitespace">                                 </span>Traceback (most recent call last)
<span class="o">&lt;</span><span class="n">ipython</span><span class="o">-</span><span class="nb">input</span><span class="o">-</span><span class="mi">6</span><span class="o">-</span><span class="mi">8201</span><span class="n">ca83d38d</span><span class="o">&gt;</span> <span class="ow">in</span> <span class="o">&lt;</span><span class="n">module</span><span class="o">&gt;</span>
<span class="ne">----&gt; </span><span class="mi">1</span> <span class="n">students</span><span class="p">[[</span><span class="s1">&#39;Major&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>

<span class="ne">NameError</span>: name &#39;students&#39; is not defined
</pre></div>
</div>
</div>
</div>
<p>We can use the same method to select a subset of columns.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">students</span><span class="p">[[</span><span class="s1">&#39;Major&#39;</span><span class="p">,</span> <span class="s1">&#39;Year&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">NameError</span><span class="g g-Whitespace">                                 </span>Traceback (most recent call last)
<span class="o">&lt;</span><span class="n">ipython</span><span class="o">-</span><span class="nb">input</span><span class="o">-</span><span class="mi">7</span><span class="o">-</span><span class="n">b56b33a352cb</span><span class="o">&gt;</span> <span class="ow">in</span> <span class="o">&lt;</span><span class="n">module</span><span class="o">&gt;</span>
<span class="ne">----&gt; </span><span class="mi">1</span> <span class="n">students</span><span class="p">[[</span><span class="s1">&#39;Major&#39;</span><span class="p">,</span> <span class="s1">&#39;Year&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>

<span class="ne">NameError</span>: name &#39;students&#39; is not defined
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="select-and-group-by">
<h2><span class="section-number">2.2.2. </span>Select and group by<a class="headerlink" href="#select-and-group-by" title="Permalink to this headline">¶</a></h2>
<p>When we have a dataframe, it is common to determine basic properties of the data.
For example, we might want to find out how many students there are from each major.
We can do this with basic select and count operations, but we have to be careful, e.g., not to double count.
Let’s illustrate this.</p>
<p>One of the most basic operations we can do on a database is to select certain rows.
For example, we can separate out each class as its own table.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">stat101</span> <span class="o">=</span> <span class="n">students</span><span class="p">[</span><span class="n">students</span><span class="p">[</span><span class="s1">&#39;Class&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;stat101&#39;</span><span class="p">]</span>
<span class="n">stat102</span> <span class="o">=</span> <span class="n">students</span><span class="p">[</span><span class="n">students</span><span class="p">[</span><span class="s1">&#39;Class&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;stat102&#39;</span><span class="p">]</span>
<span class="n">stat103</span> <span class="o">=</span> <span class="n">students</span><span class="p">[</span><span class="n">students</span><span class="p">[</span><span class="s1">&#39;Class&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;stat103&#39;</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">NameError</span><span class="g g-Whitespace">                                 </span>Traceback (most recent call last)
<span class="o">&lt;</span><span class="n">ipython</span><span class="o">-</span><span class="nb">input</span><span class="o">-</span><span class="mi">8</span><span class="o">-</span><span class="n">ea6e062ef7d4</span><span class="o">&gt;</span> <span class="ow">in</span> <span class="o">&lt;</span><span class="n">module</span><span class="o">&gt;</span>
<span class="ne">----&gt; </span><span class="mi">1</span> <span class="n">stat101</span> <span class="o">=</span> <span class="n">students</span><span class="p">[</span><span class="n">students</span><span class="p">[</span><span class="s1">&#39;Class&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;stat101&#39;</span><span class="p">]</span>
<span class="g g-Whitespace">      </span><span class="mi">2</span> <span class="n">stat102</span> <span class="o">=</span> <span class="n">students</span><span class="p">[</span><span class="n">students</span><span class="p">[</span><span class="s1">&#39;Class&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;stat102&#39;</span><span class="p">]</span>
<span class="g g-Whitespace">      </span><span class="mi">3</span> <span class="n">stat103</span> <span class="o">=</span> <span class="n">students</span><span class="p">[</span><span class="n">students</span><span class="p">[</span><span class="s1">&#39;Class&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;stat103&#39;</span><span class="p">]</span>

<span class="ne">NameError</span>: name &#39;students&#39; is not defined
</pre></div>
</div>
</div>
</div>
<p>For stat101, we have the following.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">stat101</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">NameError</span><span class="g g-Whitespace">                                 </span>Traceback (most recent call last)
<span class="o">&lt;</span><span class="n">ipython</span><span class="o">-</span><span class="nb">input</span><span class="o">-</span><span class="mi">9</span><span class="o">-</span><span class="mf">687429153e52</span><span class="o">&gt;</span> <span class="ow">in</span> <span class="o">&lt;</span><span class="n">module</span><span class="o">&gt;</span>
<span class="ne">----&gt; </span><span class="mi">1</span> <span class="n">stat101</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>

<span class="ne">NameError</span>: name &#39;stat101&#39; is not defined
</pre></div>
</div>
</div>
</div>
<p>Similarly, for stat102, we have the following.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">stat102</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">NameError</span><span class="g g-Whitespace">                                 </span>Traceback (most recent call last)
<span class="o">&lt;</span><span class="n">ipython</span><span class="o">-</span><span class="nb">input</span><span class="o">-</span><span class="mi">10</span><span class="o">-</span><span class="n">b5c80eec6d24</span><span class="o">&gt;</span> <span class="ow">in</span> <span class="o">&lt;</span><span class="n">module</span><span class="o">&gt;</span>
<span class="ne">----&gt; </span><span class="mi">1</span> <span class="n">stat102</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>

<span class="ne">NameError</span>: name &#39;stat102&#39; is not defined
</pre></div>
</div>
</div>
</div>
<p>Now suppose we wanted to find out how many students there are from each major.</p>
<p>We could try the following.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">students</span><span class="p">[</span><span class="s1">&#39;Major&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">NameError</span><span class="g g-Whitespace">                                 </span>Traceback (most recent call last)
<span class="o">&lt;</span><span class="n">ipython</span><span class="o">-</span><span class="nb">input</span><span class="o">-</span><span class="mi">11</span><span class="o">-</span><span class="mi">747</span><span class="n">b872b845f</span><span class="o">&gt;</span> <span class="ow">in</span> <span class="o">&lt;</span><span class="n">module</span><span class="o">&gt;</span>
<span class="ne">----&gt; </span><span class="mi">1</span> <span class="n">students</span><span class="p">[</span><span class="s1">&#39;Major&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span>

<span class="ne">NameError</span>: name &#39;students&#39; is not defined
</pre></div>
</div>
</div>
</div>
<p>However, if we look at the whole table, we realize that this doesn’t give us the correct answer.
The reason is that there are some students in multiple classes that are getting overcounted; the <code class="docutils literal notranslate"><span class="pre">.value_counts()</span></code> function simply counts the total number of rows within each major.</p>
<p>Instead, we should first use the ‘group by’ operation. This operation <em>partitions</em> the set of students into non-overlapping subsets. In our case, we get a different subset for each distinct major; since each student only has one major, these subsets will of course be non-overlapping. The code below first groups the rows by major and then, within each major, counts the number of unique student IDs.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">students</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;Major&#39;</span><span class="p">)[</span><span class="s1">&#39;StudentID&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">nunique</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">NameError</span><span class="g g-Whitespace">                                 </span>Traceback (most recent call last)
<span class="o">&lt;</span><span class="n">ipython</span><span class="o">-</span><span class="nb">input</span><span class="o">-</span><span class="mi">12</span><span class="o">-</span><span class="n">fe7f11c3bd00</span><span class="o">&gt;</span> <span class="ow">in</span> <span class="o">&lt;</span><span class="n">module</span><span class="o">&gt;</span>
<span class="ne">----&gt; </span><span class="mi">1</span> <span class="n">students</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;Major&#39;</span><span class="p">)[</span><span class="s1">&#39;StudentID&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">nunique</span><span class="p">()</span>

<span class="ne">NameError</span>: name &#39;students&#39; is not defined
</pre></div>
</div>
</div>
</div>
<p>Here,  the set of students has been partitioned Similarly, we can find the number of students in each year (Freshman, Sophomore, Junior, Senior) with the following:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">students</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;Year&#39;</span><span class="p">)[</span><span class="s1">&#39;StudentID&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">nunique</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">NameError</span><span class="g g-Whitespace">                                 </span>Traceback (most recent call last)
<span class="o">&lt;</span><span class="n">ipython</span><span class="o">-</span><span class="nb">input</span><span class="o">-</span><span class="mi">13</span><span class="o">-</span><span class="mi">6</span><span class="n">c251f055b1e</span><span class="o">&gt;</span> <span class="ow">in</span> <span class="o">&lt;</span><span class="n">module</span><span class="o">&gt;</span>
<span class="ne">----&gt; </span><span class="mi">1</span> <span class="n">students</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;Year&#39;</span><span class="p">)[</span><span class="s1">&#39;StudentID&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">nunique</span><span class="p">()</span>

<span class="ne">NameError</span>: name &#39;students&#39; is not defined
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="merge-and-set-operations">
<h2><span class="section-number">2.2.3. </span>Merge and set operations<a class="headerlink" href="#merge-and-set-operations" title="Permalink to this headline">¶</a></h2>
<p>It is often fruitful to think of data frames as representing sets, where each row is an element, and where we can perform basic operations from the algebra of sets covered in class.</p>
<p>Two of the most important operations we can do with sets are to take <em>unions</em> and <em>intersections</em>. The union of two sets <span class="math notranslate nohighlight">\(A\)</span> and <span class="math notranslate nohighlight">\(B\)</span> is the new set <span class="math notranslate nohighlight">\(A \cup B = \{x \mid x\in A\text{ or } x\in B\}\)</span>, or, in words, the union is the set of all elements which are either in <span class="math notranslate nohighlight">\(A\)</span> <em>or</em> in <span class="math notranslate nohighlight">\(B\)</span>. Notice that taking the union of <span class="math notranslate nohighlight">\(A\)</span> and <span class="math notranslate nohighlight">\(B\)</span> always give us a set which is at least as big as both <span class="math notranslate nohighlight">\(A\)</span> and <span class="math notranslate nohighlight">\(B\)</span>. The intersection of <span class="math notranslate nohighlight">\(A\)</span> and <span class="math notranslate nohighlight">\(B\)</span> is the set <span class="math notranslate nohighlight">\(A\cap B = \{x\mid x\in A \text{ and } x\in B\}\)</span>, in words, it’s the set of all elements which are in both <span class="math notranslate nohighlight">\(A\)</span> <em>and</em> <span class="math notranslate nohighlight">\(B\)</span>. Notice that this will generally give us a smaller set that both <span class="math notranslate nohighlight">\(A\)</span> and <span class="math notranslate nohighlight">\(B\)</span>. Below we illustrate the union and intersection using Venn diagrams.</p>
<p><img alt="" src="../_images/union-intersection.png" /></p>
<p>In the language of database operations, unions are called <em>outer joins</em>, and intersections are called <em>inner joins</em>. It is easiest to see how this works through a few examples. Let us think of each of the classes (stat101, stat102 and stat103) as sets indexed by the column StudentID.</p>
<p>First, let’s print out the Student IDs of students in stat101:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">stat101</span><span class="p">[[</span><span class="s1">&#39;StudentID&#39;</span><span class="p">]]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">NameError</span><span class="g g-Whitespace">                                 </span>Traceback (most recent call last)
<span class="o">&lt;</span><span class="n">ipython</span><span class="o">-</span><span class="nb">input</span><span class="o">-</span><span class="mi">14</span><span class="o">-</span><span class="mi">7</span><span class="n">fc7fb3cdc97</span><span class="o">&gt;</span> <span class="ow">in</span> <span class="o">&lt;</span><span class="n">module</span><span class="o">&gt;</span>
<span class="ne">----&gt; </span><span class="mi">1</span> <span class="n">stat101</span><span class="p">[[</span><span class="s1">&#39;StudentID&#39;</span><span class="p">]]</span>

<span class="ne">NameError</span>: name &#39;stat101&#39; is not defined
</pre></div>
</div>
</div>
</div>
<p>and stat102:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">stat102</span><span class="p">[[</span><span class="s1">&#39;StudentID&#39;</span><span class="p">]]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">NameError</span><span class="g g-Whitespace">                                 </span>Traceback (most recent call last)
<span class="o">&lt;</span><span class="n">ipython</span><span class="o">-</span><span class="nb">input</span><span class="o">-</span><span class="mi">15</span><span class="o">-</span><span class="mi">1</span><span class="n">f58ed9c4df6</span><span class="o">&gt;</span> <span class="ow">in</span> <span class="o">&lt;</span><span class="n">module</span><span class="o">&gt;</span>
<span class="ne">----&gt; </span><span class="mi">1</span> <span class="n">stat102</span><span class="p">[[</span><span class="s1">&#39;StudentID&#39;</span><span class="p">]]</span>

<span class="ne">NameError</span>: name &#39;stat102&#39; is not defined
</pre></div>
</div>
</div>
</div>
<p>Now, let’s find all the students in stat101 <span class="math notranslate nohighlight">\(\cup\)</span> stat102 with an outer join:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">stat101_union_102</span> <span class="o">=</span> <span class="n">stat101</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">stat102</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s1">&#39;outer&#39;</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="s1">&#39;StudentID&#39;</span><span class="p">)</span>
<span class="n">stat101_union_102</span><span class="p">[[</span><span class="s1">&#39;StudentID&#39;</span><span class="p">]]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">NameError</span><span class="g g-Whitespace">                                 </span>Traceback (most recent call last)
<span class="o">&lt;</span><span class="n">ipython</span><span class="o">-</span><span class="nb">input</span><span class="o">-</span><span class="mi">16</span><span class="o">-</span><span class="mi">155</span><span class="n">b9f95ead0</span><span class="o">&gt;</span> <span class="ow">in</span> <span class="o">&lt;</span><span class="n">module</span><span class="o">&gt;</span>
<span class="ne">----&gt; </span><span class="mi">1</span> <span class="n">stat101_union_102</span> <span class="o">=</span> <span class="n">stat101</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">stat102</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s1">&#39;outer&#39;</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="s1">&#39;StudentID&#39;</span><span class="p">)</span>
<span class="g g-Whitespace">      </span><span class="mi">2</span> <span class="n">stat101_union_102</span><span class="p">[[</span><span class="s1">&#39;StudentID&#39;</span><span class="p">]]</span>

<span class="ne">NameError</span>: name &#39;stat101&#39; is not defined
</pre></div>
</div>
</div>
</div>
<p>This code merges the tables stat101 and stat102, by taking every student that is in either one of these courses, and gives us a new (bigger) table back.</p>
<p>We can likewise find the set stat101 <span class="math notranslate nohighlight">\(\cap\)</span> stat102 with the following inner join:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">stat101_intersection_102</span> <span class="o">=</span> <span class="n">stat101</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">stat102</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s1">&#39;inner&#39;</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="s1">&#39;StudentID&#39;</span><span class="p">)</span>
<span class="n">stat101_intersection_102</span><span class="p">[[</span><span class="s1">&#39;StudentID&#39;</span><span class="p">]]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">NameError</span><span class="g g-Whitespace">                                 </span>Traceback (most recent call last)
<span class="o">&lt;</span><span class="n">ipython</span><span class="o">-</span><span class="nb">input</span><span class="o">-</span><span class="mi">17</span><span class="o">-</span><span class="n">b0bcd6631cd7</span><span class="o">&gt;</span> <span class="ow">in</span> <span class="o">&lt;</span><span class="n">module</span><span class="o">&gt;</span>
<span class="ne">----&gt; </span><span class="mi">1</span> <span class="n">stat101_intersection_102</span> <span class="o">=</span> <span class="n">stat101</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">stat102</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s1">&#39;inner&#39;</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="s1">&#39;StudentID&#39;</span><span class="p">)</span>
<span class="g g-Whitespace">      </span><span class="mi">2</span> <span class="n">stat101_intersection_102</span><span class="p">[[</span><span class="s1">&#39;StudentID&#39;</span><span class="p">]]</span>

<span class="ne">NameError</span>: name &#39;stat101&#39; is not defined
</pre></div>
</div>
</div>
</div>
<p>Note that to specify between an inner and outer join (i.e. an intersection or a union) using the Pandas <code class="docutils literal notranslate"><span class="pre">merge</span></code> function, we just need to use the option <code class="docutils literal notranslate"><span class="pre">how='inner'</span></code> or <code class="docutils literal notranslate"><span class="pre">how='outer'</span></code>.  The option <code class="docutils literal notranslate"><span class="pre">on='StudentID'</span></code> tells Pandas that we’re using the column StudentID as the index set that we’re taking the union/intersection on.</p>
</div>
<div class="section" id="set-complements-with-data-frames">
<h2><span class="section-number">2.2.4. </span>Set complements (with data frames)<a class="headerlink" href="#set-complements-with-data-frames" title="Permalink to this headline">¶</a></h2>
<p>Another one of the basic operations one can do with sets is to take <em>complements</em>. To properly define the complement of a set <span class="math notranslate nohighlight">\(A\)</span>, we need to have a larger set <span class="math notranslate nohighlight">\(X\)</span> for which <span class="math notranslate nohighlight">\(A\subseteq X\)</span>. Sometimes, this is simply all of the rows in the data frame. Then we can define <span class="math notranslate nohighlight">\(A^c = \{x\in X : x\not\in A\}\)</span>. We can use the select operations we learned earlier to calculate complements.</p>
<p>For example, suppose we wanted to find stat<span class="math notranslate nohighlight">\(101^c\)</span>. To do this, we use the ‘isin’ function from numpy, which returns an array of True and False values describing whether each element in the first array is in the second array. For example, <code class="docutils literal notranslate"><span class="pre">numpy.isin([1,2,3],</span> <span class="pre">[1,2])</span></code> would return <code class="docutils literal notranslate"><span class="pre">[True,</span> <span class="pre">True,</span> <span class="pre">False]</span></code>, since 1 and 2 are in <code class="docutils literal notranslate"><span class="pre">[1,2]</span></code> but 3 is not. We also use the function <code class="docutils literal notranslate"><span class="pre">numpy.logical_not</span></code>, which finds the logical negation of each element in a boolean array. For example, <code class="docutils literal notranslate"><span class="pre">numpy.logical_not([True,</span> <span class="pre">True,</span> <span class="pre">False])</span> <span class="pre">=</span> <span class="pre">[False,</span> <span class="pre">False,</span> <span class="pre">True]</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span>

<span class="n">stat101_complement</span> <span class="o">=</span> <span class="n">students</span><span class="p">[</span><span class="n">numpy</span><span class="o">.</span><span class="n">logical_not</span><span class="p">(</span><span class="n">numpy</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">students</span><span class="p">[</span><span class="s1">&#39;StudentID&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">stat101</span><span class="p">[</span><span class="s1">&#39;StudentID&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">))]</span>
<span class="n">stat101_complement</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">NameError</span><span class="g g-Whitespace">                                 </span>Traceback (most recent call last)
<span class="o">&lt;</span><span class="n">ipython</span><span class="o">-</span><span class="nb">input</span><span class="o">-</span><span class="mi">18</span><span class="o">-</span><span class="mi">0</span><span class="n">f6d69a9efd6</span><span class="o">&gt;</span> <span class="ow">in</span> <span class="o">&lt;</span><span class="n">module</span><span class="o">&gt;</span>
<span class="g g-Whitespace">      </span><span class="mi">1</span> <span class="kn">import</span> <span class="nn">numpy</span>
<span class="g g-Whitespace">      </span><span class="mi">2</span> 
<span class="ne">----&gt; </span><span class="mi">3</span> <span class="n">stat101_complement</span> <span class="o">=</span> <span class="n">students</span><span class="p">[</span><span class="n">numpy</span><span class="o">.</span><span class="n">logical_not</span><span class="p">(</span><span class="n">numpy</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">students</span><span class="p">[</span><span class="s1">&#39;StudentID&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">stat101</span><span class="p">[</span><span class="s1">&#39;StudentID&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">))]</span>
<span class="g g-Whitespace">      </span><span class="mi">4</span> <span class="n">stat101_complement</span>

<span class="ne">NameError</span>: name &#39;students&#39; is not defined
</pre></div>
</div>
</div>
</div>
<p>Similarly, we can use the below code to find the complement of the set <code class="docutils literal notranslate"><span class="pre">freshman</span></code> of all freshman students.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">freshman</span> <span class="o">=</span> <span class="n">students</span><span class="p">[</span><span class="n">students</span><span class="p">[</span><span class="s1">&#39;Year&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Freshman&#39;</span><span class="p">]</span>
<span class="n">freshman_complement</span> <span class="o">=</span> <span class="n">students</span><span class="p">[</span><span class="n">numpy</span><span class="o">.</span><span class="n">logical_not</span><span class="p">(</span><span class="n">numpy</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">students</span><span class="p">[</span><span class="s1">&#39;StudentID&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">freshman</span><span class="p">[</span><span class="s1">&#39;StudentID&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">))]</span>
<span class="n">freshman_complement</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">NameError</span><span class="g g-Whitespace">                                 </span>Traceback (most recent call last)
<span class="o">&lt;</span><span class="n">ipython</span><span class="o">-</span><span class="nb">input</span><span class="o">-</span><span class="mi">19</span><span class="o">-</span><span class="n">acfd53d9f423</span><span class="o">&gt;</span> <span class="ow">in</span> <span class="o">&lt;</span><span class="n">module</span><span class="o">&gt;</span>
<span class="ne">----&gt; </span><span class="mi">1</span> <span class="n">freshman</span> <span class="o">=</span> <span class="n">students</span><span class="p">[</span><span class="n">students</span><span class="p">[</span><span class="s1">&#39;Year&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Freshman&#39;</span><span class="p">]</span>
<span class="g g-Whitespace">      </span><span class="mi">2</span> <span class="n">freshman_complement</span> <span class="o">=</span> <span class="n">students</span><span class="p">[</span><span class="n">numpy</span><span class="o">.</span><span class="n">logical_not</span><span class="p">(</span><span class="n">numpy</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">students</span><span class="p">[</span><span class="s1">&#39;StudentID&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">freshman</span><span class="p">[</span><span class="s1">&#39;StudentID&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">))]</span>
<span class="g g-Whitespace">      </span><span class="mi">3</span> <span class="n">freshman_complement</span>

<span class="ne">NameError</span>: name &#39;students&#39; is not defined
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="set-associativity-with-data-frames">
<h2><span class="section-number">2.2.5. </span>Set associativity (with data frames)<a class="headerlink" href="#set-associativity-with-data-frames" title="Permalink to this headline">¶</a></h2>
<p>Now that we’ve seen how to take unions and intersections, we can illustrate other properties, starting with the associative property.</p>
<p>Recall that the <em>associative property</em> (of unions) states that for sets <span class="math notranslate nohighlight">\(A,B\)</span> and <span class="math notranslate nohighlight">\(C\)</span>, we have <span class="math notranslate nohighlight">\((A\cup B)\cup C = A \cup (B\cup B)\)</span>; that is, it doesn’t matter in which order we take unions.</p>
<p>In the cells below, we use outer joins to verify this property, by showing that (stat101 <span class="math notranslate nohighlight">\(\cup\)</span> stat102) <span class="math notranslate nohighlight">\(\cup\)</span> stat103 = stat101 <span class="math notranslate nohighlight">\(\cup\)</span> (stat102 <span class="math notranslate nohighlight">\(\cup\)</span> stat103).</p>
<p>First, we compute stat 101 <span class="math notranslate nohighlight">\(\cup\)</span> stat 102, by performing an outer join.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">stat101_union_102</span> <span class="o">=</span> <span class="n">stat101</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">stat102</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s1">&#39;outer&#39;</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="s1">&#39;StudentID&#39;</span><span class="p">)</span>
<span class="n">stat101_union_102</span><span class="p">[[</span><span class="s1">&#39;StudentID&#39;</span><span class="p">]]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">NameError</span><span class="g g-Whitespace">                                 </span>Traceback (most recent call last)
<span class="o">&lt;</span><span class="n">ipython</span><span class="o">-</span><span class="nb">input</span><span class="o">-</span><span class="mi">20</span><span class="o">-</span><span class="mi">155</span><span class="n">b9f95ead0</span><span class="o">&gt;</span> <span class="ow">in</span> <span class="o">&lt;</span><span class="n">module</span><span class="o">&gt;</span>
<span class="ne">----&gt; </span><span class="mi">1</span> <span class="n">stat101_union_102</span> <span class="o">=</span> <span class="n">stat101</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">stat102</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s1">&#39;outer&#39;</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="s1">&#39;StudentID&#39;</span><span class="p">)</span>
<span class="g g-Whitespace">      </span><span class="mi">2</span> <span class="n">stat101_union_102</span><span class="p">[[</span><span class="s1">&#39;StudentID&#39;</span><span class="p">]]</span>

<span class="ne">NameError</span>: name &#39;stat101&#39; is not defined
</pre></div>
</div>
</div>
</div>
<p>Next, we perform another outer join with stat103 to compute (stat101 <span class="math notranslate nohighlight">\(\cup\)</span> stat102) <span class="math notranslate nohighlight">\(\cup\)</span> stat103.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">stat101u102_union_103</span> <span class="o">=</span> <span class="n">stat101_union_102</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">stat103</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s1">&#39;outer&#39;</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="s1">&#39;StudentID&#39;</span><span class="p">)</span>
<span class="n">stat101u102_union_103</span><span class="p">[[</span><span class="s1">&#39;StudentID&#39;</span><span class="p">]]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">NameError</span><span class="g g-Whitespace">                                 </span>Traceback (most recent call last)
<span class="o">&lt;</span><span class="n">ipython</span><span class="o">-</span><span class="nb">input</span><span class="o">-</span><span class="mi">21</span><span class="o">-</span><span class="mi">8</span><span class="n">a7335c5c69f</span><span class="o">&gt;</span> <span class="ow">in</span> <span class="o">&lt;</span><span class="n">module</span><span class="o">&gt;</span>
<span class="ne">----&gt; </span><span class="mi">1</span> <span class="n">stat101u102_union_103</span> <span class="o">=</span> <span class="n">stat101_union_102</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">stat103</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s1">&#39;outer&#39;</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="s1">&#39;StudentID&#39;</span><span class="p">)</span>
<span class="g g-Whitespace">      </span><span class="mi">2</span> <span class="n">stat101u102_union_103</span><span class="p">[[</span><span class="s1">&#39;StudentID&#39;</span><span class="p">]]</span>

<span class="ne">NameError</span>: name &#39;stat101_union_102&#39; is not defined
</pre></div>
</div>
</div>
</div>
<p>Next, we move on to computing the right-hand side. We start with (stat102 <span class="math notranslate nohighlight">\(\cup\)</span> stat103):</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">stat102_union_103</span> <span class="o">=</span> <span class="n">stat102</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">stat103</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s1">&#39;outer&#39;</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="s1">&#39;StudentID&#39;</span><span class="p">)</span>
<span class="n">stat102_union_103</span><span class="p">[[</span><span class="s1">&#39;StudentID&#39;</span><span class="p">]]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">NameError</span><span class="g g-Whitespace">                                 </span>Traceback (most recent call last)
<span class="o">&lt;</span><span class="n">ipython</span><span class="o">-</span><span class="nb">input</span><span class="o">-</span><span class="mi">22</span><span class="o">-</span><span class="mi">9</span><span class="n">f63c7c06034</span><span class="o">&gt;</span> <span class="ow">in</span> <span class="o">&lt;</span><span class="n">module</span><span class="o">&gt;</span>
<span class="ne">----&gt; </span><span class="mi">1</span> <span class="n">stat102_union_103</span> <span class="o">=</span> <span class="n">stat102</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">stat103</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s1">&#39;outer&#39;</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="s1">&#39;StudentID&#39;</span><span class="p">)</span>
<span class="g g-Whitespace">      </span><span class="mi">2</span> <span class="n">stat102_union_103</span><span class="p">[[</span><span class="s1">&#39;StudentID&#39;</span><span class="p">]]</span>

<span class="ne">NameError</span>: name &#39;stat102&#39; is not defined
</pre></div>
</div>
</div>
</div>
<p>And finally, we take an outer join with stat101 to find stat101 <span class="math notranslate nohighlight">\(\cup\)</span> (stat102 <span class="math notranslate nohighlight">\(\cup\)</span> stat103).</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">stat102u103_union_101</span> <span class="o">=</span> <span class="n">stat102_union_103</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">stat101</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s1">&#39;outer&#39;</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="s1">&#39;StudentID&#39;</span><span class="p">)</span>
<span class="n">stat102u103_union_101</span><span class="p">[[</span><span class="s1">&#39;StudentID&#39;</span><span class="p">]]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">NameError</span><span class="g g-Whitespace">                                 </span>Traceback (most recent call last)
<span class="o">&lt;</span><span class="n">ipython</span><span class="o">-</span><span class="nb">input</span><span class="o">-</span><span class="mi">23</span><span class="o">-</span><span class="mi">9</span><span class="n">b96ce898318</span><span class="o">&gt;</span> <span class="ow">in</span> <span class="o">&lt;</span><span class="n">module</span><span class="o">&gt;</span>
<span class="ne">----&gt; </span><span class="mi">1</span> <span class="n">stat102u103_union_101</span> <span class="o">=</span> <span class="n">stat102_union_103</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">stat101</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s1">&#39;outer&#39;</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="s1">&#39;StudentID&#39;</span><span class="p">)</span>
<span class="g g-Whitespace">      </span><span class="mi">2</span> <span class="n">stat102u103_union_101</span><span class="p">[[</span><span class="s1">&#39;StudentID&#39;</span><span class="p">]]</span>

<span class="ne">NameError</span>: name &#39;stat102_union_103&#39; is not defined
</pre></div>
</div>
</div>
</div>
<p>As we can see visually, the sets <code class="docutils literal notranslate"><span class="pre">stat101u102_union_103</span></code> and <code class="docutils literal notranslate"><span class="pre">stat102u103_union_101</span></code> are indeed equal! We can also check this using code:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">set</span><span class="p">(</span><span class="n">stat101u102_union_103</span><span class="p">[</span><span class="s1">&#39;StudentID&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">)</span> <span class="o">==</span> <span class="nb">set</span><span class="p">(</span><span class="n">stat102u103_union_101</span><span class="p">[</span><span class="s1">&#39;StudentID&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">NameError</span><span class="g g-Whitespace">                                 </span>Traceback (most recent call last)
<span class="o">&lt;</span><span class="n">ipython</span><span class="o">-</span><span class="nb">input</span><span class="o">-</span><span class="mi">24</span><span class="o">-</span><span class="n">cbea6f141420</span><span class="o">&gt;</span> <span class="ow">in</span> <span class="o">&lt;</span><span class="n">module</span><span class="o">&gt;</span>
<span class="ne">----&gt; </span><span class="mi">1</span> <span class="nb">set</span><span class="p">(</span><span class="n">stat101u102_union_103</span><span class="p">[</span><span class="s1">&#39;StudentID&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">)</span> <span class="o">==</span> <span class="nb">set</span><span class="p">(</span><span class="n">stat102u103_union_101</span><span class="p">[</span><span class="s1">&#39;StudentID&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">)</span>

<span class="ne">NameError</span>: name &#39;stat101u102_union_103&#39; is not defined
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="set-distributivity-with-data-frames">
<h2><span class="section-number">2.2.6. </span>Set distributivity (with data frames)<a class="headerlink" href="#set-distributivity-with-data-frames" title="Permalink to this headline">¶</a></h2>
<p>The next property which we will verify is the <em>distributive property</em> of intersections over unions (there is also a distributive property of unions over intersection, which you will verify in the homework). This distribution property states that for sets <span class="math notranslate nohighlight">\(A,B\)</span> and <span class="math notranslate nohighlight">\(C\)</span>, we have that <span class="math notranslate nohighlight">\(A\cap(B\cup C) = (A\cap B) \cup (A\cap C)\)</span>.</p>
<p>Here, we will demonstrate this property by showing that stat101 <span class="math notranslate nohighlight">\(\cap\)</span> (stat102 <span class="math notranslate nohighlight">\(\cup\)</span> stat103) = (stat101 <span class="math notranslate nohighlight">\(\cap\)</span> stat102) <span class="math notranslate nohighlight">\(\cup\)</span> (stat101 <span class="math notranslate nohighlight">\(\cap\)</span> stat103). Noe that to do this, we need to use both inner and outer joins, to compute intersections and unions, respectively.</p>
<p>Let’s start by computing the left-hand side, first by computing (stat102 <span class="math notranslate nohighlight">\(\cup\)</span> stat103) with an outer join, and then taking an inner join with stat101.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">stat102_union_103</span> <span class="o">=</span> <span class="n">stat102</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">stat103</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s1">&#39;outer&#39;</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="s1">&#39;StudentID&#39;</span><span class="p">)</span>
<span class="n">stat101_intersection_102u103</span> <span class="o">=</span> <span class="n">stat101</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">stat102_union_103</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s1">&#39;inner&#39;</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="s1">&#39;StudentID&#39;</span><span class="p">)</span>
<span class="n">stat101_intersection_102u103</span><span class="p">[[</span><span class="s1">&#39;StudentID&#39;</span><span class="p">]]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">NameError</span><span class="g g-Whitespace">                                 </span>Traceback (most recent call last)
<span class="o">&lt;</span><span class="n">ipython</span><span class="o">-</span><span class="nb">input</span><span class="o">-</span><span class="mi">25</span><span class="o">-</span><span class="mi">1</span><span class="n">afbd58fac82</span><span class="o">&gt;</span> <span class="ow">in</span> <span class="o">&lt;</span><span class="n">module</span><span class="o">&gt;</span>
<span class="ne">----&gt; </span><span class="mi">1</span> <span class="n">stat102_union_103</span> <span class="o">=</span> <span class="n">stat102</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">stat103</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s1">&#39;outer&#39;</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="s1">&#39;StudentID&#39;</span><span class="p">)</span>
<span class="g g-Whitespace">      </span><span class="mi">2</span> <span class="n">stat101_intersection_102u103</span> <span class="o">=</span> <span class="n">stat101</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">stat102_union_103</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s1">&#39;inner&#39;</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="s1">&#39;StudentID&#39;</span><span class="p">)</span>
<span class="g g-Whitespace">      </span><span class="mi">3</span> <span class="n">stat101_intersection_102u103</span><span class="p">[[</span><span class="s1">&#39;StudentID&#39;</span><span class="p">]]</span>

<span class="ne">NameError</span>: name &#39;stat102&#39; is not defined
</pre></div>
</div>
</div>
</div>
<p>Next, let’s compute the right-hand side. We do this by taking two inner joins to find the sets (stat101 <span class="math notranslate nohighlight">\(\cap\)</span> stat102) and (stat101 <span class="math notranslate nohighlight">\(\cap\)</span> stat103), and then taking an outer join to find the union of them.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">stat101_intersection_102</span> <span class="o">=</span> <span class="n">stat101</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">stat102</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s1">&#39;inner&#39;</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="s1">&#39;StudentID&#39;</span><span class="p">)</span>
<span class="n">stat101_intersection_103</span> <span class="o">=</span> <span class="n">stat101</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">stat103</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s1">&#39;inner&#39;</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="s1">&#39;StudentID&#39;</span><span class="p">)</span>
<span class="n">stat101n102_union_101n103</span> <span class="o">=</span> <span class="n">stat101_intersection_102</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">stat101_intersection_103</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s1">&#39;outer&#39;</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="s1">&#39;StudentID&#39;</span><span class="p">)</span>
<span class="n">stat101n102_union_101n103</span><span class="p">[[</span><span class="s1">&#39;StudentID&#39;</span><span class="p">]]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">NameError</span><span class="g g-Whitespace">                                 </span>Traceback (most recent call last)
<span class="o">&lt;</span><span class="n">ipython</span><span class="o">-</span><span class="nb">input</span><span class="o">-</span><span class="mi">26</span><span class="o">-</span><span class="mi">4</span><span class="n">c2f7617807b</span><span class="o">&gt;</span> <span class="ow">in</span> <span class="o">&lt;</span><span class="n">module</span><span class="o">&gt;</span>
<span class="ne">----&gt; </span><span class="mi">1</span> <span class="n">stat101_intersection_102</span> <span class="o">=</span> <span class="n">stat101</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">stat102</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s1">&#39;inner&#39;</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="s1">&#39;StudentID&#39;</span><span class="p">)</span>
<span class="g g-Whitespace">      </span><span class="mi">2</span> <span class="n">stat101_intersection_103</span> <span class="o">=</span> <span class="n">stat101</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">stat103</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s1">&#39;inner&#39;</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="s1">&#39;StudentID&#39;</span><span class="p">)</span>
<span class="g g-Whitespace">      </span><span class="mi">3</span> <span class="n">stat101n102_union_101n103</span> <span class="o">=</span> <span class="n">stat101_intersection_102</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">stat101_intersection_103</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s1">&#39;outer&#39;</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="s1">&#39;StudentID&#39;</span><span class="p">)</span>
<span class="g g-Whitespace">      </span><span class="mi">4</span> <span class="n">stat101n102_union_101n103</span><span class="p">[[</span><span class="s1">&#39;StudentID&#39;</span><span class="p">]]</span>

<span class="ne">NameError</span>: name &#39;stat101&#39; is not defined
</pre></div>
</div>
</div>
</div>
<p>As we can see visually, the sets <code class="docutils literal notranslate"><span class="pre">stat101_intersection_102u103</span></code> and <code class="docutils literal notranslate"><span class="pre">stat101n102_union_101n103</span></code> are indeed equal. However, we can again check this with code.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">set</span><span class="p">(</span><span class="n">stat101_intersection_102u103</span><span class="p">[</span><span class="s1">&#39;StudentID&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">)</span> <span class="o">==</span> <span class="nb">set</span><span class="p">(</span><span class="n">stat101n102_union_101n103</span><span class="p">[</span><span class="s1">&#39;StudentID&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">NameError</span><span class="g g-Whitespace">                                 </span>Traceback (most recent call last)
<span class="o">&lt;</span><span class="n">ipython</span><span class="o">-</span><span class="nb">input</span><span class="o">-</span><span class="mi">27</span><span class="o">-</span><span class="n">d7721332364e</span><span class="o">&gt;</span> <span class="ow">in</span> <span class="o">&lt;</span><span class="n">module</span><span class="o">&gt;</span>
<span class="ne">----&gt; </span><span class="mi">1</span> <span class="nb">set</span><span class="p">(</span><span class="n">stat101_intersection_102u103</span><span class="p">[</span><span class="s1">&#39;StudentID&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">)</span> <span class="o">==</span> <span class="nb">set</span><span class="p">(</span><span class="n">stat101n102_union_101n103</span><span class="p">[</span><span class="s1">&#39;StudentID&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">)</span>

<span class="ne">NameError</span>: name &#39;stat101_intersection_102u103&#39; is not defined
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="set-idempotence-with-data-frames">
<h2><span class="section-number">2.2.7. </span>Set idempotence (with data frames)<a class="headerlink" href="#set-idempotence-with-data-frames" title="Permalink to this headline">¶</a></h2>
<p>In Section 2.1 on sets, we saw that the union operation was idempotent, meaning that for sets <span class="math notranslate nohighlight">\(A\)</span> and <span class="math notranslate nohighlight">\(B\)</span>, we have that <span class="math notranslate nohighlight">\(A\cup B = (A\cup B) \cup B\)</span>. Another way to formalize this is to define the operation <span class="math notranslate nohighlight">\(G\)</span>, which takes in a set <span class="math notranslate nohighlight">\(A\)</span> and returns the set <span class="math notranslate nohighlight">\(A\cup B\)</span>, namely: <span class="math notranslate nohighlight">\(G(A) = A \cup B\)</span>. Then we can equivalently state that for any set <span class="math notranslate nohighlight">\(A\)</span>, <span class="math notranslate nohighlight">\(G(G(A)) = G(A)\)</span>. Later, when we discuss functions, we will see that this means that <span class="math notranslate nohighlight">\(G\)</span> is an identity function on its image (don’t worry about this terminology for now). Here we will verify this idempotence property for unions using data frames and outer joins.</p>
<p>For this demonstration, we’ll use the sets juniors101 (juniors in the class stat 101) and seniors102 (seniors in the class stat 102), which we define below.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">juniors101</span> <span class="o">=</span> <span class="n">stat101</span><span class="p">[</span><span class="n">stat101</span><span class="p">[</span><span class="s1">&#39;Year&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Junior&#39;</span><span class="p">]</span>
<span class="n">seniors102</span> <span class="o">=</span> <span class="n">stat102</span><span class="p">[</span><span class="n">stat102</span><span class="p">[</span><span class="s1">&#39;Year&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Senior&#39;</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">NameError</span><span class="g g-Whitespace">                                 </span>Traceback (most recent call last)
<span class="o">&lt;</span><span class="n">ipython</span><span class="o">-</span><span class="nb">input</span><span class="o">-</span><span class="mi">28</span><span class="o">-</span><span class="n">aa1b87857b69</span><span class="o">&gt;</span> <span class="ow">in</span> <span class="o">&lt;</span><span class="n">module</span><span class="o">&gt;</span>
<span class="ne">----&gt; </span><span class="mi">1</span> <span class="n">juniors101</span> <span class="o">=</span> <span class="n">stat101</span><span class="p">[</span><span class="n">stat101</span><span class="p">[</span><span class="s1">&#39;Year&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Junior&#39;</span><span class="p">]</span>
<span class="g g-Whitespace">      </span><span class="mi">2</span> <span class="n">seniors102</span> <span class="o">=</span> <span class="n">stat102</span><span class="p">[</span><span class="n">stat102</span><span class="p">[</span><span class="s1">&#39;Year&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Senior&#39;</span><span class="p">]</span>

<span class="ne">NameError</span>: name &#39;stat101&#39; is not defined
</pre></div>
</div>
</div>
</div>
<p>Let’s first use an outer join to compute juniors101 <span class="math notranslate nohighlight">\(\cup\)</span> seniors102.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">juniors101_u_seniors102</span> <span class="o">=</span> <span class="n">juniors101</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">seniors102</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s1">&#39;outer&#39;</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="s1">&#39;StudentID&#39;</span><span class="p">)</span>
<span class="n">juniors101_u_seniors102</span><span class="p">[[</span><span class="s1">&#39;StudentID&#39;</span><span class="p">]]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">NameError</span><span class="g g-Whitespace">                                 </span>Traceback (most recent call last)
<span class="o">&lt;</span><span class="n">ipython</span><span class="o">-</span><span class="nb">input</span><span class="o">-</span><span class="mi">29</span><span class="o">-</span><span class="mi">754038101</span><span class="n">d11</span><span class="o">&gt;</span> <span class="ow">in</span> <span class="o">&lt;</span><span class="n">module</span><span class="o">&gt;</span>
<span class="ne">----&gt; </span><span class="mi">1</span> <span class="n">juniors101_u_seniors102</span> <span class="o">=</span> <span class="n">juniors101</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">seniors102</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s1">&#39;outer&#39;</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="s1">&#39;StudentID&#39;</span><span class="p">)</span>
<span class="g g-Whitespace">      </span><span class="mi">2</span> <span class="n">juniors101_u_seniors102</span><span class="p">[[</span><span class="s1">&#39;StudentID&#39;</span><span class="p">]]</span>

<span class="ne">NameError</span>: name &#39;juniors101&#39; is not defined
</pre></div>
</div>
</div>
</div>
<p>Next, let’s verify the idempotence property of the union with seniors, namely that juniors101 <span class="math notranslate nohighlight">\(\cup\)</span> seniors102 = (juniors101 <span class="math notranslate nohighlight">\(\cup\)</span> seniors102) <span class="math notranslate nohighlight">\(\cup\)</span> seniors102:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">juniors101_u_seniors102_u_seniors102</span> <span class="o">=</span> <span class="n">juniors101_u_seniors102</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">seniors102</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s1">&#39;outer&#39;</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="s1">&#39;StudentID&#39;</span><span class="p">)</span>
<span class="n">juniors101_u_seniors102_u_seniors102</span><span class="p">[[</span><span class="s1">&#39;StudentID&#39;</span><span class="p">]]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">NameError</span><span class="g g-Whitespace">                                 </span>Traceback (most recent call last)
<span class="o">&lt;</span><span class="n">ipython</span><span class="o">-</span><span class="nb">input</span><span class="o">-</span><span class="mi">30</span><span class="o">-</span><span class="mf">878e630</span><span class="n">cc73c</span><span class="o">&gt;</span> <span class="ow">in</span> <span class="o">&lt;</span><span class="n">module</span><span class="o">&gt;</span>
<span class="ne">----&gt; </span><span class="mi">1</span> <span class="n">juniors101_u_seniors102_u_seniors102</span> <span class="o">=</span> <span class="n">juniors101_u_seniors102</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">seniors102</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s1">&#39;outer&#39;</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="s1">&#39;StudentID&#39;</span><span class="p">)</span>
<span class="g g-Whitespace">      </span><span class="mi">2</span> <span class="n">juniors101_u_seniors102_u_seniors102</span><span class="p">[[</span><span class="s1">&#39;StudentID&#39;</span><span class="p">]]</span>

<span class="ne">NameError</span>: name &#39;juniors101_u_seniors102&#39; is not defined
</pre></div>
</div>
</div>
</div>
<p>As we can see visually, the two sets consist of the same student ID are the same. We can also verify this using code:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">set</span><span class="p">(</span><span class="n">juniors101_u_seniors102_u_seniors102</span><span class="p">[</span><span class="s1">&#39;StudentID&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">)</span> <span class="o">==</span> <span class="nb">set</span><span class="p">(</span><span class="n">juniors101_u_seniors102</span><span class="p">[</span><span class="s1">&#39;StudentID&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">NameError</span><span class="g g-Whitespace">                                 </span>Traceback (most recent call last)
<span class="o">&lt;</span><span class="n">ipython</span><span class="o">-</span><span class="nb">input</span><span class="o">-</span><span class="mi">31</span><span class="o">-</span><span class="mi">717</span><span class="n">d3607458b</span><span class="o">&gt;</span> <span class="ow">in</span> <span class="o">&lt;</span><span class="n">module</span><span class="o">&gt;</span>
<span class="ne">----&gt; </span><span class="mi">1</span> <span class="nb">set</span><span class="p">(</span><span class="n">juniors101_u_seniors102_u_seniors102</span><span class="p">[</span><span class="s1">&#39;StudentID&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">)</span> <span class="o">==</span> <span class="nb">set</span><span class="p">(</span><span class="n">juniors101_u_seniors102</span><span class="p">[</span><span class="s1">&#39;StudentID&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">)</span>

<span class="ne">NameError</span>: name &#39;juniors101_u_seniors102_u_seniors102&#39; is not defined
</pre></div>
</div>
</div>
</div>
<p>In the homework, we will see that a similar idempotence property also holds for intersections.</p>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./10_Overview"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
        </div>
    </div>
    
    
    <div class='prev-next-bottom'>
        
    <a class='left-prev' id="prev-link" href="chap2_sets.html" title="previous page"><span class="section-number">2.1. </span>Sets and Set Algebra</a>
    <a class='right-next' id="next-link" href="hw01.html" title="next page"><span class="section-number">2.3. </span>Homework 1</a>

    </div>
    <footer class="footer mt-5 mt-md-0">
    <div class="container">
      <p>
        
          By Michael W. Mahoney, N. Benjamin Erichson and Ryan Theisen<br/>
        
            &copy; Copyright 2021.<br/>
      </p>
    </div>
  </footer>
</main>


      </div>
    </div>

    
  <script src="../_static/js/index.d3f166471bb80abb5163.js"></script>


    
  </body>
</html>
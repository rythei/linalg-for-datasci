
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>2.4. Functions and Compositions &#8212; Linear Algebra for Data Workbook</title>
    
  <link rel="stylesheet" href="../_static/css/index.f658d18f9b420779cfdf24aa0a7e2d77.css">

    
  <link rel="stylesheet"
    href="../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      
  <link rel="stylesheet"
    href="../_static/vendor/open-sans_all/1.44.1/index.css">
  <link rel="stylesheet"
    href="../_static/vendor/lato_latin-ext/1.44.1/index.css">

    
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../_static/sphinx-book-theme.40e2e510f6b7d1648584402491bb10fe.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="../_static/js/index.d3f166471bb80abb5163.js">

    <script id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/togglebutton.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script >var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../_static/sphinx-book-theme.d31b09fe5c1d09cb49b26a786de4a05d.js"></script>
    <script async="async" src="https://unpkg.com/thebelab@latest/lib/index.js"></script>
    <script >
        const thebe_selector = ".thebe"
        const thebe_selector_input = "pre"
        const thebe_selector_output = ".output"
    </script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["\\(", "\\)"]], "displayMath": [["\\[", "\\]"]], "processRefs": false, "processEnvironments": false}})</script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="2.5. Homework 2" href="hw02.html" />
    <link rel="prev" title="2.3. Homework 1" href="hw01.html" />

    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="en" />



  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
<a class="navbar-brand text-wrap" href="../index.html">
  
  <img src="../_static/logo.png" class="logo" alt="logo">
  
  
  <h1 class="site-logo" id="site-title">Linear Algebra for Data Workbook</h1>
  
</a>
</div><form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form>
<nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">
    <ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="../overview.html">
   Welcome to Stat 89A
  </a>
 </li>
</ul>
<p class="caption collapsible-parent">
 <span class="caption-text">
  Background
 </span>
</p>
<ul class="nav sidenav_l1">
 <li class="toctree-l1 collapsible-parent">
  <a class="reference internal" href="../00_Background/python_overview.html">
   1. (CH0): Python 101
  </a>
  <ul class="collapse-ul">
   <li class="toctree-l2">
    <a class="reference internal" href="../00_Background/basics.html">
     1.1. The Basics
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../00_Background/numpy.html">
     1.2. NumPy
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../00_Background/plotting.html">
     1.3. MatPlotLib
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../00_Background/playground0.html">
     1.4. Play Ground
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../00_Background/hw0.html">
     1.5. Homework 0: Due Sunday January 24, 2021, 11:59 PM CA time
    </a>
   </li>
  </ul>
  <i class="fas fa-chevron-down">
  </i>
 </li>
</ul>
<p class="caption collapsible-parent">
 <span class="caption-text">
  Introduction and Overview
 </span>
</p>
<ul class="current nav sidenav_l1">
 <li class="toctree-l1 collapsible-parent">
  <a class="reference internal" href="chap1_introduction_header.html">
   1. (CH1): Introduction and Overview
  </a>
  <ul class="collapse-ul">
   <li class="toctree-l2">
    <a class="reference internal" href="chap1_overview.html">
     1.1. Linear Algebra for Data
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="chap1_examples.html">
     1.2. Examples
    </a>
   </li>
  </ul>
  <i class="fas fa-chevron-down">
  </i>
 </li>
 <li class="toctree-l1 current active collapsible-parent">
  <a class="reference internal" href="chap2_algebras_header.html">
   2. (CH2): Algebra, algebras, and functions
  </a>
  <ul class="current collapse-ul">
   <li class="toctree-l2">
    <a class="reference internal" href="chap2_sets.html">
     2.1. Sets and Set Algebra
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="chap2_basic-table-operations.html">
     2.2. Data Frames and Set Operations
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="hw01.html">
     2.3. Homework 1
    </a>
   </li>
   <li class="toctree-l2 current active">
    <a class="current reference internal" href="#">
     2.4. Functions and Compositions
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="hw02.html">
     2.5. Homework 2
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="chap2_injective-functions-and-left-inverses.html">
     2.6. Injective Functions and Left Inverses
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="chap2_surjective-functions-and-right-inverses.html">
     2.7. Surjective Functions and Right Inverses
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="chap2_generalized-inverses.html">
     2.8. Generalized inverses
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="hw03.html">
     2.9. Homework 3
    </a>
   </li>
  </ul>
  <i class="fas fa-chevron-down">
  </i>
 </li>
</ul>

</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="row topbar fixed-top container-xl">
    <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show">
    </div>
    <div class="col pl-2 topbar-main">
        
        <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
            data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
            aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
            title="Toggle navigation" data-toggle="tooltip" data-placement="left">
            <i class="fas fa-bars"></i>
            <i class="fas fa-arrow-left"></i>
            <i class="fas fa-arrow-up"></i>
        </button>
        
        
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        <a class="dropdown-buttons"
            href="../_sources/10_Overview/chap2_functions-and-compositions.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download notebook file" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="../_sources/10_Overview/chap2_functions-and-compositions.md"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.md</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
            onClick="window.print()" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

        <!-- Source interaction buttons -->


        <!-- Full screen (wrap in <a> to have style consistency -->
        <a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
                data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
                title="Fullscreen mode"><i
                    class="fas fa-expand"></i></button></a>

        <!-- Launch buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Launch interactive content"><i class="fas fa-rocket"></i></button>
    <div class="dropdown-buttons">
        
        <a class="binder-button" href="https://mybinder.org/v2/gh/erichson/LinearAlgebra/master?urlpath=tree/10_Overview/chap2_functions-and-compositions.md"><button type="button"
                class="btn btn-secondary topbarbtn" title="Launch Binder" data-toggle="tooltip"
                data-placement="left"><img class="binder-button-logo"
                    src="../_static/images/logo_binder.svg"
                    alt="Interact on binder">Binder</button></a>
        
        
        
        
    </div>
</div>

    </div>

    <!-- Table of contents -->
    <div class="d-none d-md-block col-md-2 bd-toc show">
        
        <div class="tocsection onthispage pt-5 pb-3">
            <i class="fas fa-list"></i> Contents
        </div>
        <nav id="bd-toc-nav">
            <ul class="nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#functions-via-binary-relations">
   2.4.1. Functions via binary relations
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#image-preimage-and-restriction">
   2.4.2. Image/preimage and restriction
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#composition-of-functions">
   2.4.3. Composition of functions
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#associativity-of-function-composition">
   2.4.4. Associativity of function composition
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#function-compositions-yield-the-identity">
   2.4.5. Function compositions yield the Identity
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#idempotent-projection-functions">
   2.4.6. Idempotent/projection functions
  </a>
 </li>
</ul>

        </nav>
        
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
        
              <div>
                
  <div class="section" id="functions-and-compositions">
<h1><span class="section-number">2.4. </span>Functions and Compositions<a class="headerlink" href="#functions-and-compositions" title="Permalink to this headline">¶</a></h1>
<p>In this section, we will continue with data frames, and we will use them to discuss functions and the composition of functions.<br />
Topics to be covered include the following.</p>
<ul class="simple">
<li><p>Binary relations, functions, and defining functions in terms of basic data frame operations.</p></li>
<li><p>Image/preimage of functions and restrictions of functions.</p></li>
<li><p>Composition of functions, and how to use data frame operations to compose two functions together.</p></li>
<li><p>Associativity of function composition.</p></li>
<li><p>Identity versus idempotence.</p></li>
</ul>
<p>We will again work with the <code class="docutils literal notranslate"><span class="pre">students</span></code> dataset, which we import below.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">from</span> <span class="nn">datasets</span> <span class="k">import</span> <span class="n">students</span>
<span class="n">students</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">FileNotFoundError</span><span class="g g-Whitespace">                         </span>Traceback (most recent call last)
<span class="o">&lt;</span><span class="n">ipython</span><span class="o">-</span><span class="nb">input</span><span class="o">-</span><span class="mi">1</span><span class="o">-</span><span class="n">faf3a7d27977</span><span class="o">&gt;</span> <span class="ow">in</span> <span class="o">&lt;</span><span class="n">module</span><span class="o">&gt;</span>
<span class="g g-Whitespace">      </span><span class="mi">1</span> <span class="kn">import</span> <span class="nn">pandas</span> <span class="kn">as</span> <span class="nn">pd</span>
<span class="ne">----&gt; </span><span class="mi">2</span> <span class="kn">from</span> <span class="nn">datasets</span> <span class="kn">import</span> <span class="n">students</span>
<span class="g g-Whitespace">      </span><span class="mi">3</span> <span class="n">students</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>

<span class="o">/</span><span class="n">Volumes</span><span class="o">/</span><span class="n">GoogleDrive</span><span class="o">-</span><span class="mi">112349428810515690974</span><span class="o">/</span><span class="n">My</span> <span class="n">Drive</span><span class="o">/</span><span class="n">PhD</span><span class="o">/</span><span class="n">Teaching</span><span class="o">/</span><span class="n">Stat89A_Spring2022</span><span class="o">/</span><span class="n">linalg</span><span class="o">-</span><span class="k">for</span><span class="o">-</span><span class="n">datasci</span><span class="o">/</span><span class="mi">10</span><span class="n">_Overview</span><span class="o">/</span><span class="n">datasets</span><span class="o">.</span><span class="n">py</span> <span class="ow">in</span> <span class="o">&lt;</span><span class="n">module</span><span class="o">&gt;</span>
<span class="g g-Whitespace">      </span><span class="mi">5</span> <span class="n">HERE</span> <span class="o">=</span> <span class="s2">&quot;../datasets/&quot;</span>
<span class="g g-Whitespace">      </span><span class="mi">6</span> 
<span class="ne">----&gt; </span><span class="mi">7</span> <span class="n">circuit_courts</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">HERE</span><span class="p">,</span> <span class="s2">&quot;circuit_courts.csv&quot;</span><span class="p">))</span>
<span class="g g-Whitespace">      </span><span class="mi">8</span> 
<span class="g g-Whitespace">      </span><span class="mi">9</span> <span class="n">discretized_functions</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">HERE</span><span class="p">,</span> <span class="s2">&quot;discretized_functions.csv&quot;</span><span class="p">))</span>

<span class="nn">/usr/local/lib/python3.7/site-packages/pandas/io/parsers.py</span> in <span class="ni">read_csv</span><span class="nt">(filepath_or_buffer, sep, delimiter, header, names, index_col, usecols, squeeze, prefix, mangle_dupe_cols, dtype, engine, converters, true_values, false_values, skipinitialspace, skiprows, skipfooter, nrows, na_values, keep_default_na, na_filter, verbose, skip_blank_lines, parse_dates, infer_datetime_format, keep_date_col, date_parser, dayfirst, cache_dates, iterator, chunksize, compression, thousands, decimal, lineterminator, quotechar, quoting, doublequote, escapechar, comment, encoding, dialect, error_bad_lines, warn_bad_lines, delim_whitespace, low_memory, memory_map, float_precision, storage_options)</span>
<span class="g g-Whitespace">    </span><span class="mi">603</span>     <span class="n">kwds</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">kwds_defaults</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">604</span> 
<span class="ne">--&gt; </span><span class="mi">605</span>     <span class="k">return</span> <span class="n">_read</span><span class="p">(</span><span class="n">filepath_or_buffer</span><span class="p">,</span> <span class="n">kwds</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">606</span> 
<span class="g g-Whitespace">    </span><span class="mi">607</span> 

<span class="nn">/usr/local/lib/python3.7/site-packages/pandas/io/parsers.py</span> in <span class="ni">_read</span><span class="nt">(filepath_or_buffer, kwds)</span>
<span class="g g-Whitespace">    </span><span class="mi">455</span> 
<span class="g g-Whitespace">    </span><span class="mi">456</span>     <span class="c1"># Create the parser.</span>
<span class="ne">--&gt; </span><span class="mi">457</span>     <span class="n">parser</span> <span class="o">=</span> <span class="n">TextFileReader</span><span class="p">(</span><span class="n">filepath_or_buffer</span><span class="p">,</span> <span class="o">**</span><span class="n">kwds</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">458</span> 
<span class="g g-Whitespace">    </span><span class="mi">459</span>     <span class="k">if</span> <span class="n">chunksize</span> <span class="ow">or</span> <span class="n">iterator</span><span class="p">:</span>

<span class="nn">/usr/local/lib/python3.7/site-packages/pandas/io/parsers.py</span> in <span class="ni">__init__</span><span class="nt">(self, f, engine, **kwds)</span>
<span class="g g-Whitespace">    </span><span class="mi">812</span>             <span class="bp">self</span><span class="o">.</span><span class="n">options</span><span class="p">[</span><span class="s2">&quot;has_index_names&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">kwds</span><span class="p">[</span><span class="s2">&quot;has_index_names&quot;</span><span class="p">]</span>
<span class="g g-Whitespace">    </span><span class="mi">813</span> 
<span class="ne">--&gt; </span><span class="mi">814</span>         <span class="bp">self</span><span class="o">.</span><span class="n">_engine</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_make_engine</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">engine</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">815</span> 
<span class="g g-Whitespace">    </span><span class="mi">816</span>     <span class="k">def</span> <span class="nf">close</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>

<span class="nn">/usr/local/lib/python3.7/site-packages/pandas/io/parsers.py</span> in <span class="ni">_make_engine</span><span class="nt">(self, engine)</span>
<span class="g g-Whitespace">   </span><span class="mi">1043</span>             <span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">1044</span>         <span class="c1"># error: Too many arguments for &quot;ParserBase&quot;</span>
<span class="ne">-&gt; </span><span class="mi">1045</span>         <span class="k">return</span> <span class="n">mapping</span><span class="p">[</span><span class="n">engine</span><span class="p">](</span><span class="bp">self</span><span class="o">.</span><span class="n">f</span><span class="p">,</span> <span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">options</span><span class="p">)</span>  <span class="c1"># type: ignore[call-arg]</span>
<span class="g g-Whitespace">   </span><span class="mi">1046</span> 
<span class="g g-Whitespace">   </span><span class="mi">1047</span>     <span class="k">def</span> <span class="nf">_failover_to_python</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>

<span class="nn">/usr/local/lib/python3.7/site-packages/pandas/io/parsers.py</span> in <span class="ni">__init__</span><span class="nt">(self, src, **kwds)</span>
<span class="g g-Whitespace">   </span><span class="mi">1860</span> 
<span class="g g-Whitespace">   </span><span class="mi">1861</span>         <span class="c1"># open handles</span>
<span class="ne">-&gt; </span><span class="mi">1862</span>         <span class="bp">self</span><span class="o">.</span><span class="n">_open_handles</span><span class="p">(</span><span class="n">src</span><span class="p">,</span> <span class="n">kwds</span><span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">1863</span>         <span class="k">assert</span> <span class="bp">self</span><span class="o">.</span><span class="n">handles</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span>
<span class="g g-Whitespace">   </span><span class="mi">1864</span>         <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="p">(</span><span class="s2">&quot;storage_options&quot;</span><span class="p">,</span> <span class="s2">&quot;encoding&quot;</span><span class="p">,</span> <span class="s2">&quot;memory_map&quot;</span><span class="p">,</span> <span class="s2">&quot;compression&quot;</span><span class="p">):</span>

<span class="nn">/usr/local/lib/python3.7/site-packages/pandas/io/parsers.py</span> in <span class="ni">_open_handles</span><span class="nt">(self, src, kwds)</span>
<span class="g g-Whitespace">   </span><span class="mi">1361</span>             <span class="n">compression</span><span class="o">=</span><span class="n">kwds</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;compression&quot;</span><span class="p">,</span> <span class="bp">None</span><span class="p">),</span>
<span class="g g-Whitespace">   </span><span class="mi">1362</span>             <span class="n">memory_map</span><span class="o">=</span><span class="n">kwds</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;memory_map&quot;</span><span class="p">,</span> <span class="bp">False</span><span class="p">),</span>
<span class="ne">-&gt; </span><span class="mi">1363</span>             <span class="n">storage_options</span><span class="o">=</span><span class="n">kwds</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;storage_options&quot;</span><span class="p">,</span> <span class="bp">None</span><span class="p">),</span>
<span class="g g-Whitespace">   </span><span class="mi">1364</span>         <span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">1365</span> 

<span class="nn">/usr/local/lib/python3.7/site-packages/pandas/io/common.py</span> in <span class="ni">get_handle</span><span class="nt">(path_or_buf, mode, encoding, compression, memory_map, is_text, errors, storage_options)</span>
<span class="g g-Whitespace">    </span><span class="mi">642</span>                 <span class="n">encoding</span><span class="o">=</span><span class="n">ioargs</span><span class="o">.</span><span class="n">encoding</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">643</span>                 <span class="n">errors</span><span class="o">=</span><span class="n">errors</span><span class="p">,</span>
<span class="ne">--&gt; </span><span class="mi">644</span>                 <span class="n">newline</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">645</span>             <span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">646</span>         <span class="k">else</span><span class="p">:</span>

<span class="ne">FileNotFoundError</span>: [Errno 2] No such file or directory: &#39;../datasets/circuit_courts.csv&#39;
</pre></div>
</div>
</div>
</div>
<div class="section" id="functions-via-binary-relations">
<h2><span class="section-number">2.4.1. </span>Functions via binary relations<a class="headerlink" href="#functions-via-binary-relations" title="Permalink to this headline">¶</a></h2>
<p>Functions seem simple enough.
You probably know that a function is (something like) a rule that assigns to each input one output.
That’s not incorrect, but it is not the full story.
When we use functions in data science, we typically want to combine and compose them in various ways.
In that case, it is better to think of them as black box subroutines, and it is more important to be careful about the domain and range of the function.
To do that, let’s start with a slightly more general notion, and then let’s get more specific to different types of functions.</p>
<p>A binary relation is defined in the following way.
Given two sets, <span class="math notranslate nohighlight">\(A\)</span> and <span class="math notranslate nohighlight">\(B\)</span>, a binary relation between <span class="math notranslate nohighlight">\(A\)</span> and <span class="math notranslate nohighlight">\(B\)</span> is a triple <span class="math notranslate nohighlight">\(\langle A, R, B \rangle\)</span>, where <span class="math notranslate nohighlight">\( R \subset A \times B\)</span> is any set of ordered paris from <span class="math notranslate nohighlight">\(A \times B\)</span>.
For example, we could have <span class="math notranslate nohighlight">\(A = \)</span><code class="docutils literal notranslate"><span class="pre">StudentID</span></code> and <span class="math notranslate nohighlight">\(B = \)</span><code class="docutils literal notranslate"><span class="pre">grade</span></code> and have <span class="math notranslate nohighlight">\(\langle a,b \rangle \in R\)</span> iff student <span class="math notranslate nohighlight">\(a\)</span> has the grade <span class="math notranslate nohighlight">\(b\)</span>.</p>
<p>We can view this relation using the students data frame by simply selecting the columns StudentID and Grade:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">students</span><span class="p">[[</span><span class="s1">&#39;StudentID&#39;</span><span class="p">,</span> <span class="s1">&#39;Grade&#39;</span><span class="p">]]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">NameError</span><span class="g g-Whitespace">                                 </span>Traceback (most recent call last)
<span class="o">&lt;</span><span class="n">ipython</span><span class="o">-</span><span class="nb">input</span><span class="o">-</span><span class="mi">2</span><span class="o">-</span><span class="n">cda7ac84392c</span><span class="o">&gt;</span> <span class="ow">in</span> <span class="o">&lt;</span><span class="n">module</span><span class="o">&gt;</span>
<span class="ne">----&gt; </span><span class="mi">1</span> <span class="n">students</span><span class="p">[[</span><span class="s1">&#39;StudentID&#39;</span><span class="p">,</span> <span class="s1">&#39;Grade&#39;</span><span class="p">]]</span>

<span class="ne">NameError</span>: name &#39;students&#39; is not defined
</pre></div>
</div>
</div>
</div>
<p>Note that this is <em>not</em> a function, since a student is in general in multiple classes, but it is a binary relation.
For example, for <code class="docutils literal notranslate"><span class="pre">StudentID</span> <span class="pre">==</span> <span class="pre">101</span></code>, we see the following.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">tmp</span> <span class="o">=</span> <span class="n">students</span><span class="p">[[</span><span class="s1">&#39;StudentID&#39;</span><span class="p">,</span> <span class="s1">&#39;Grade&#39;</span><span class="p">]]</span>
<span class="n">student101</span> <span class="o">=</span> <span class="n">tmp</span><span class="p">[</span><span class="n">tmp</span><span class="p">[</span><span class="s1">&#39;StudentID&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">101</span><span class="p">]</span>
<span class="n">student101</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">NameError</span><span class="g g-Whitespace">                                 </span>Traceback (most recent call last)
<span class="o">&lt;</span><span class="n">ipython</span><span class="o">-</span><span class="nb">input</span><span class="o">-</span><span class="mi">3</span><span class="o">-</span><span class="mi">20882299</span><span class="n">d1c2</span><span class="o">&gt;</span> <span class="ow">in</span> <span class="o">&lt;</span><span class="n">module</span><span class="o">&gt;</span>
<span class="ne">----&gt; </span><span class="mi">1</span> <span class="n">tmp</span> <span class="o">=</span> <span class="n">students</span><span class="p">[[</span><span class="s1">&#39;StudentID&#39;</span><span class="p">,</span> <span class="s1">&#39;Grade&#39;</span><span class="p">]]</span>
<span class="g g-Whitespace">      </span><span class="mi">2</span> <span class="n">student101</span> <span class="o">=</span> <span class="n">tmp</span><span class="p">[</span><span class="n">tmp</span><span class="p">[</span><span class="s1">&#39;StudentID&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">101</span><span class="p">]</span>
<span class="g g-Whitespace">      </span><span class="mi">3</span> <span class="n">student101</span>

<span class="ne">NameError</span>: name &#39;students&#39; is not defined
</pre></div>
</div>
</div>
</div>
<p>Note also that we could have a student enrolled in no classes, and we could have a class with no students in it.
Sometimes that could be encoded in the data frame, and sometimes it would not be, e.g., if the data frame only has students who are enrolled in at least one class.
However, that is worth keeping in mind.</p>
<p>On the other hand, we could construct a function from <code class="docutils literal notranslate"><span class="pre">StudentID</span></code> to <code class="docutils literal notranslate"><span class="pre">Grade</span></code>.
To do this, we need to find a way to choose a grade value to assign for students in multiple classes.
Below, we do this by taking <span class="math notranslate nohighlight">\(f(StudentID)\)</span> to be the maximum grade that student with ID <code class="docutils literal notranslate"><span class="pre">StudentID</span></code> has in any class.
To do this, we again need the group by operation introduced in the previous workbooks.
(Note: we need to use the option <code class="docutils literal notranslate"><span class="pre">as_index=False</span></code> to make sure Pandas doesn’t try to use StudentID as the index – this just makes the tables look nice.)</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">students_to_grades</span> <span class="o">=</span> <span class="n">students</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;StudentID&#39;</span><span class="p">,</span> <span class="n">as_index</span><span class="o">=</span><span class="kc">False</span><span class="p">)[[</span><span class="s1">&#39;StudentID&#39;</span><span class="p">,</span> <span class="s1">&#39;Grade&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="s1">&#39;Grade&#39;</span><span class="p">)</span>
<span class="n">students_to_grades</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">NameError</span><span class="g g-Whitespace">                                 </span>Traceback (most recent call last)
<span class="o">&lt;</span><span class="n">ipython</span><span class="o">-</span><span class="nb">input</span><span class="o">-</span><span class="mi">4</span><span class="o">-</span><span class="n">c4c22b181d8e</span><span class="o">&gt;</span> <span class="ow">in</span> <span class="o">&lt;</span><span class="n">module</span><span class="o">&gt;</span>
<span class="ne">----&gt; </span><span class="mi">1</span> <span class="n">students_to_grades</span> <span class="o">=</span> <span class="n">students</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;StudentID&#39;</span><span class="p">,</span> <span class="n">as_index</span><span class="o">=</span><span class="bp">False</span><span class="p">)[[</span><span class="s1">&#39;StudentID&#39;</span><span class="p">,</span> <span class="s1">&#39;Grade&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="s1">&#39;Grade&#39;</span><span class="p">)</span>
<span class="g g-Whitespace">      </span><span class="mi">2</span> <span class="n">students_to_grades</span>

<span class="ne">NameError</span>: name &#39;students&#39; is not defined
</pre></div>
</div>
</div>
</div>
<p>This is a function.
For example, for <code class="docutils literal notranslate"><span class="pre">StudentID</span> <span class="pre">==</span> <span class="pre">101</span></code> we see the following.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">tmp</span> <span class="o">=</span> <span class="n">students_to_grades</span><span class="p">[[</span><span class="s1">&#39;StudentID&#39;</span><span class="p">,</span> <span class="s1">&#39;Grade&#39;</span><span class="p">]]</span>
<span class="n">student101</span> <span class="o">=</span> <span class="n">tmp</span><span class="p">[</span><span class="n">tmp</span><span class="p">[</span><span class="s1">&#39;StudentID&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">101</span><span class="p">]</span>
<span class="n">student101</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">NameError</span><span class="g g-Whitespace">                                 </span>Traceback (most recent call last)
<span class="o">&lt;</span><span class="n">ipython</span><span class="o">-</span><span class="nb">input</span><span class="o">-</span><span class="mi">5</span><span class="o">-</span><span class="mi">4</span><span class="n">fc30584a144</span><span class="o">&gt;</span> <span class="ow">in</span> <span class="o">&lt;</span><span class="n">module</span><span class="o">&gt;</span>
<span class="ne">----&gt; </span><span class="mi">1</span> <span class="n">tmp</span> <span class="o">=</span> <span class="n">students_to_grades</span><span class="p">[[</span><span class="s1">&#39;StudentID&#39;</span><span class="p">,</span> <span class="s1">&#39;Grade&#39;</span><span class="p">]]</span>
<span class="g g-Whitespace">      </span><span class="mi">2</span> <span class="n">student101</span> <span class="o">=</span> <span class="n">tmp</span><span class="p">[</span><span class="n">tmp</span><span class="p">[</span><span class="s1">&#39;StudentID&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">101</span><span class="p">]</span>
<span class="g g-Whitespace">      </span><span class="mi">3</span> <span class="n">student101</span>

<span class="ne">NameError</span>: name &#39;students_to_grades&#39; is not defined
</pre></div>
</div>
</div>
</div>
<p>To verify that this a function in code, we can check to make sure every student ID appears only once:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">students_to_grades</span><span class="p">[[</span><span class="s1">&#39;StudentID&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">NameError</span><span class="g g-Whitespace">                                 </span>Traceback (most recent call last)
<span class="o">&lt;</span><span class="n">ipython</span><span class="o">-</span><span class="nb">input</span><span class="o">-</span><span class="mi">6</span><span class="o">-</span><span class="mi">140392</span><span class="n">d233e3</span><span class="o">&gt;</span> <span class="ow">in</span> <span class="o">&lt;</span><span class="n">module</span><span class="o">&gt;</span>
<span class="ne">----&gt; </span><span class="mi">1</span> <span class="n">students_to_grades</span><span class="p">[[</span><span class="s1">&#39;StudentID&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span>

<span class="ne">NameError</span>: name &#39;students_to_grades&#39; is not defined
</pre></div>
</div>
</div>
</div>
<p>However, this was not the only way we could have constructed this function.
For example, we also could have constructed a function from <code class="docutils literal notranslate"><span class="pre">StudentID</span></code> to <code class="docutils literal notranslate"><span class="pre">Grade</span></code> by selecting the minimum grade, or the average grade.</p>
</div>
<div class="section" id="image-preimage-and-restriction">
<h2><span class="section-number">2.4.2. </span>Image/preimage and restriction<a class="headerlink" href="#image-preimage-and-restriction" title="Permalink to this headline">¶</a></h2>
<p>If a function is a rule that maps points from a set <span class="math notranslate nohighlight">\(A\)</span> to set <span class="math notranslate nohighlight">\(B\)</span>, then the <em>image</em> of <span class="math notranslate nohighlight">\(f\)</span> is the subset of <span class="math notranslate nohighlight">\(B\)</span> that gets mapped to by some element <span class="math notranslate nohighlight">\(a \in A\)</span>, and the preimage of <span class="math notranslate nohighlight">\(f\)</span> is the subset of <span class="math notranslate nohighlight">\(f\)</span> is the subset of <span class="math notranslate nohighlight">\(A\)</span> that maps to something.
Think, <em>range</em> and <em>domain</em>.</p>
<p>We can also have the image of a subset of <span class="math notranslate nohighlight">\(A\)</span>.
For example, consider the function <span class="math notranslate nohighlight">\(f:\)</span><code class="docutils literal notranslate"><span class="pre">StudentID</span></code> <span class="math notranslate nohighlight">\(\to\)</span> <code class="docutils literal notranslate"><span class="pre">Grade</span></code>  that we defined above and the subset <code class="docutils literal notranslate"><span class="pre">sophomore</span></code> <span class="math notranslate nohighlight">\(\subseteq\)</span>  <code class="docutils literal notranslate"><span class="pre">StudentID</span></code> of sophomore students. We can compute the image of the subset <code class="docutils literal notranslate"><span class="pre">sophomore</span></code> under the function <code class="docutils literal notranslate"><span class="pre">students_to_grades</span> </code>, denoted <span class="math notranslate nohighlight">\(f(\text{sophomore})\)</span> which we obtain with the following code:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sophomore</span> <span class="o">=</span> <span class="n">students</span><span class="p">[</span><span class="n">students</span><span class="p">[</span><span class="s1">&#39;Year&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Sophomore&#39;</span><span class="p">][</span><span class="s1">&#39;StudentID&#39;</span><span class="p">]</span>
<span class="n">students_to_grades</span><span class="p">[</span><span class="n">students_to_grades</span><span class="p">[</span><span class="s1">&#39;StudentID&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">sophomore</span><span class="p">)][[</span><span class="s1">&#39;Grade&#39;</span><span class="p">]]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">NameError</span><span class="g g-Whitespace">                                 </span>Traceback (most recent call last)
<span class="o">&lt;</span><span class="n">ipython</span><span class="o">-</span><span class="nb">input</span><span class="o">-</span><span class="mi">7</span><span class="o">-</span><span class="n">e5709ebb4fbf</span><span class="o">&gt;</span> <span class="ow">in</span> <span class="o">&lt;</span><span class="n">module</span><span class="o">&gt;</span>
<span class="ne">----&gt; </span><span class="mi">1</span> <span class="n">sophomore</span> <span class="o">=</span> <span class="n">students</span><span class="p">[</span><span class="n">students</span><span class="p">[</span><span class="s1">&#39;Year&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Sophomore&#39;</span><span class="p">][</span><span class="s1">&#39;StudentID&#39;</span><span class="p">]</span>
<span class="g g-Whitespace">      </span><span class="mi">2</span> <span class="n">students_to_grades</span><span class="p">[</span><span class="n">students_to_grades</span><span class="p">[</span><span class="s1">&#39;StudentID&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">sophomore</span><span class="p">)][[</span><span class="s1">&#39;Grade&#39;</span><span class="p">]]</span>

<span class="ne">NameError</span>: name &#39;students&#39; is not defined
</pre></div>
</div>
</div>
</div>
<p>Note that the resulting set is a subset of the set <code class="docutils literal notranslate"><span class="pre">Grade</span></code>.
Likewise, we could consider the pre-image of some subset of grades under this function.
For example, let’s consider the subset of grades <code class="docutils literal notranslate"><span class="pre">[84,</span> <span class="pre">76,</span> <span class="pre">81,</span> <span class="pre">95]</span></code>.
We can obtain the pre-image of this set under the function <span class="math notranslate nohighlight">\(f\)</span>, denoted <span class="math notranslate nohighlight">\(f^{-1}(\{84,76,81,95\})\)</span>, which is just the set of students who have one of these grades as their maximum grade:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">students_to_grades</span><span class="p">[</span><span class="n">students_to_grades</span><span class="p">[</span><span class="s1">&#39;Grade&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">isin</span><span class="p">([</span><span class="mi">84</span><span class="p">,</span> <span class="mi">76</span><span class="p">,</span> <span class="mi">81</span><span class="p">,</span> <span class="mi">95</span><span class="p">])][[</span><span class="s1">&#39;StudentID&#39;</span><span class="p">]]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">NameError</span><span class="g g-Whitespace">                                 </span>Traceback (most recent call last)
<span class="o">&lt;</span><span class="n">ipython</span><span class="o">-</span><span class="nb">input</span><span class="o">-</span><span class="mi">8</span><span class="o">-</span><span class="n">e6f15d6cd031</span><span class="o">&gt;</span> <span class="ow">in</span> <span class="o">&lt;</span><span class="n">module</span><span class="o">&gt;</span>
<span class="ne">----&gt; </span><span class="mi">1</span> <span class="n">students_to_grades</span><span class="p">[</span><span class="n">students_to_grades</span><span class="p">[</span><span class="s1">&#39;Grade&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">isin</span><span class="p">([</span><span class="mi">84</span><span class="p">,</span> <span class="mi">76</span><span class="p">,</span> <span class="mi">81</span><span class="p">,</span> <span class="mi">95</span><span class="p">])][[</span><span class="s1">&#39;StudentID&#39;</span><span class="p">]]</span>

<span class="ne">NameError</span>: name &#39;students_to_grades&#39; is not defined
</pre></div>
</div>
</div>
</div>
<p>Alternatively, we can obtain the set of all students whose highest grade is in the 80s as a pre-image under the function <code class="docutils literal notranslate"><span class="pre">students_to_grades</span></code></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">grades_in_80s</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">80</span><span class="p">,</span><span class="mi">90</span><span class="p">))</span> <span class="c1">#[80, 81, 82, ... , 88, 89]</span>
<span class="n">students_to_grades</span><span class="p">[</span><span class="n">students_to_grades</span><span class="p">[</span><span class="s1">&#39;Grade&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">grades_in_80s</span><span class="p">)][[</span><span class="s1">&#39;StudentID&#39;</span><span class="p">]]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">NameError</span><span class="g g-Whitespace">                                 </span>Traceback (most recent call last)
<span class="o">&lt;</span><span class="n">ipython</span><span class="o">-</span><span class="nb">input</span><span class="o">-</span><span class="mi">9</span><span class="o">-</span><span class="mi">0</span><span class="n">f6883f0dd00</span><span class="o">&gt;</span> <span class="ow">in</span> <span class="o">&lt;</span><span class="n">module</span><span class="o">&gt;</span>
<span class="g g-Whitespace">      </span><span class="mi">1</span> <span class="n">grades_in_80s</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">80</span><span class="p">,</span><span class="mi">90</span><span class="p">))</span> <span class="c1">#[80, 81, 82, ... , 88, 89]</span>
<span class="ne">----&gt; </span><span class="mi">2</span> <span class="n">students_to_grades</span><span class="p">[</span><span class="n">students_to_grades</span><span class="p">[</span><span class="s1">&#39;Grade&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">grades_in_80s</span><span class="p">)][[</span><span class="s1">&#39;StudentID&#39;</span><span class="p">]]</span>

<span class="ne">NameError</span>: name &#39;students_to_grades&#39; is not defined
</pre></div>
</div>
</div>
</div>
<p>Given that, a useful notion is the <em>restriction</em> of a function.
Informally, this is the same function, except it is defined on a subset of <span class="math notranslate nohighlight">\(A\)</span> and/or <span class="math notranslate nohighlight">\(B\)</span>.
Let’s look the function <code class="docutils literal notranslate"><span class="pre">students_to_grades</span></code> restricted to the set of sophomores, which we denote by <span class="math notranslate nohighlight">\(f|_{\text{sophomore}}\)</span>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sophomore_students_to_grades</span> <span class="o">=</span> <span class="n">students_to_grades</span><span class="p">[</span><span class="n">students_to_grades</span><span class="p">[</span><span class="s1">&#39;StudentID&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">sophomore</span><span class="p">)]</span>
<span class="n">sophomore_students_to_grades</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">NameError</span><span class="g g-Whitespace">                                 </span>Traceback (most recent call last)
<span class="o">&lt;</span><span class="n">ipython</span><span class="o">-</span><span class="nb">input</span><span class="o">-</span><span class="mi">10</span><span class="o">-</span><span class="mi">25</span><span class="n">fc79bb3bdc</span><span class="o">&gt;</span> <span class="ow">in</span> <span class="o">&lt;</span><span class="n">module</span><span class="o">&gt;</span>
<span class="ne">----&gt; </span><span class="mi">1</span> <span class="n">sophomore_students_to_grades</span> <span class="o">=</span> <span class="n">students_to_grades</span><span class="p">[</span><span class="n">students_to_grades</span><span class="p">[</span><span class="s1">&#39;StudentID&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">sophomore</span><span class="p">)]</span>
<span class="g g-Whitespace">      </span><span class="mi">2</span> <span class="n">sophomore_students_to_grades</span>

<span class="ne">NameError</span>: name &#39;students_to_grades&#39; is not defined
</pre></div>
</div>
</div>
</div>
<p>Notice that when we have a <em>partial function</em> – i.e. a function which is not defined on the entire domain – we can construct a total function simply by restricting it to the elements of its domain which it is defined on.</p>
</div>
<div class="section" id="composition-of-functions">
<h2><span class="section-number">2.4.3. </span>Composition of functions<a class="headerlink" href="#composition-of-functions" title="Permalink to this headline">¶</a></h2>
<p>Something that one often wants to do is to compose two functions.
Informally, this means that we apply a second function on the output of the first function.
In symbols, if <span class="math notranslate nohighlight">\(f:A\to B\)</span> and <span class="math notranslate nohighlight">\(g:B\to C\)</span>, then the composition of these function is a new function <span class="math notranslate nohighlight">\(g\circ f : A\to C\)</span> defined by <span class="math notranslate nohighlight">\((g\circ f)(a) = g(f(a))\)</span>.</p>
<p>When working with function composition, we want to think of the functions as balck boxes, and we are interested in how those black boxes compose, i.e., we are not interested in the particular inputs/outputs of the functions.
Thus, the main gotcha when working with function composition has to do with when the function isn’t defined for all elements of the input domain and/or doesn’t map to all elements of the output domain.
Let’s see this with an example.</p>
<p>First, let’s consider the function from <code class="docutils literal notranslate"><span class="pre">StudentID</span></code> to <code class="docutils literal notranslate"><span class="pre">Year</span></code> :</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">students_to_year</span> <span class="o">=</span> <span class="n">students</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;StudentID&#39;</span><span class="p">,</span> <span class="n">as_index</span><span class="o">=</span><span class="kc">False</span><span class="p">)[[</span><span class="s1">&#39;StudentID&#39;</span><span class="p">,</span><span class="s1">&#39;Year&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">first</span><span class="p">()</span>
<span class="n">students_to_year</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">NameError</span><span class="g g-Whitespace">                                 </span>Traceback (most recent call last)
<span class="o">&lt;</span><span class="n">ipython</span><span class="o">-</span><span class="nb">input</span><span class="o">-</span><span class="mi">11</span><span class="o">-</span><span class="mi">2</span><span class="n">b72ef46b069</span><span class="o">&gt;</span> <span class="ow">in</span> <span class="o">&lt;</span><span class="n">module</span><span class="o">&gt;</span>
<span class="ne">----&gt; </span><span class="mi">1</span> <span class="n">students_to_year</span> <span class="o">=</span> <span class="n">students</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;StudentID&#39;</span><span class="p">,</span> <span class="n">as_index</span><span class="o">=</span><span class="bp">False</span><span class="p">)[[</span><span class="s1">&#39;StudentID&#39;</span><span class="p">,</span><span class="s1">&#39;Year&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">first</span><span class="p">()</span>
<span class="g g-Whitespace">      </span><span class="mi">2</span> <span class="n">students_to_year</span>

<span class="ne">NameError</span>: name &#39;students&#39; is not defined
</pre></div>
</div>
</div>
</div>
<p>This is a well-defined function, because each student only has a single year.
On the other hand, what happens if we try to map back from <code class="docutils literal notranslate"><span class="pre">Year</span></code> to <code class="docutils literal notranslate"><span class="pre">StudentID</span></code>?
Since there is more than one student in each year, there is not a unique way to define such a function.</p>
<p>For example, for each year, we could select the student with the smallest student ID:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">year_to_students1</span> <span class="o">=</span> <span class="n">students</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;Year&#39;</span><span class="p">,</span>  <span class="n">as_index</span><span class="o">=</span><span class="kc">False</span><span class="p">)[[</span><span class="s1">&#39;Year&#39;</span><span class="p">,</span> <span class="s1">&#39;StudentID&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="s1">&#39;StudentID&#39;</span><span class="p">)</span>
<span class="n">year_to_students1</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">NameError</span><span class="g g-Whitespace">                                 </span>Traceback (most recent call last)
<span class="o">&lt;</span><span class="n">ipython</span><span class="o">-</span><span class="nb">input</span><span class="o">-</span><span class="mi">12</span><span class="o">-</span><span class="n">a21951c8db6b</span><span class="o">&gt;</span> <span class="ow">in</span> <span class="o">&lt;</span><span class="n">module</span><span class="o">&gt;</span>
<span class="ne">----&gt; </span><span class="mi">1</span> <span class="n">year_to_students1</span> <span class="o">=</span> <span class="n">students</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;Year&#39;</span><span class="p">,</span>  <span class="n">as_index</span><span class="o">=</span><span class="bp">False</span><span class="p">)[[</span><span class="s1">&#39;Year&#39;</span><span class="p">,</span> <span class="s1">&#39;StudentID&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="s1">&#39;StudentID&#39;</span><span class="p">)</span>
<span class="g g-Whitespace">      </span><span class="mi">2</span> <span class="n">year_to_students1</span>

<span class="ne">NameError</span>: name &#39;students&#39; is not defined
</pre></div>
</div>
</div>
</div>
<p>However, it would also be perfectly valid to select the student in each year with the largest student ID number:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">year_to_students2</span> <span class="o">=</span> <span class="n">students</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;Year&#39;</span><span class="p">,</span>  <span class="n">as_index</span><span class="o">=</span><span class="kc">False</span><span class="p">)[[</span><span class="s1">&#39;Year&#39;</span><span class="p">,</span><span class="s1">&#39;StudentID&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="s1">&#39;StudentID&#39;</span><span class="p">)</span>
<span class="n">year_to_students2</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">NameError</span><span class="g g-Whitespace">                                 </span>Traceback (most recent call last)
<span class="o">&lt;</span><span class="n">ipython</span><span class="o">-</span><span class="nb">input</span><span class="o">-</span><span class="mi">13</span><span class="o">-</span><span class="mi">80</span><span class="n">b69371cae5</span><span class="o">&gt;</span> <span class="ow">in</span> <span class="o">&lt;</span><span class="n">module</span><span class="o">&gt;</span>
<span class="ne">----&gt; </span><span class="mi">1</span> <span class="n">year_to_students2</span> <span class="o">=</span> <span class="n">students</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;Year&#39;</span><span class="p">,</span>  <span class="n">as_index</span><span class="o">=</span><span class="bp">False</span><span class="p">)[[</span><span class="s1">&#39;Year&#39;</span><span class="p">,</span><span class="s1">&#39;StudentID&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="s1">&#39;StudentID&#39;</span><span class="p">)</span>
<span class="g g-Whitespace">      </span><span class="mi">2</span> <span class="n">year_to_students2</span>

<span class="ne">NameError</span>: name &#39;students&#39; is not defined
</pre></div>
</div>
</div>
</div>
<p>Let’s see what happens when we compose these functions with our function <code class="docutils literal notranslate"><span class="pre">students_to_year</span></code>.
It turns out that we can do this again using <em>joins</em>, similar to how we used them to perform set intersections. In particular, we can perform a left join, which is essentially just an inner join between the domain of <code class="docutils literal notranslate"><span class="pre">year_to_students1</span></code> and the co-domain of <code class="docutils literal notranslate"><span class="pre">students_to_year</span></code>.
Since both of these sets are subsets of the set <code class="docutils literal notranslate"><span class="pre">year</span></code>, such a join makes sense.
Below we see how to do this in Python:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">students_to_students1</span> <span class="o">=</span> <span class="n">students_to_year</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">year_to_students1</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s2">&quot;left&quot;</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="s2">&quot;Year&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="s2">&quot;Year&quot;</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">students_to_students1</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">NameError</span><span class="g g-Whitespace">                                 </span>Traceback (most recent call last)
<span class="o">&lt;</span><span class="n">ipython</span><span class="o">-</span><span class="nb">input</span><span class="o">-</span><span class="mi">14</span><span class="o">-</span><span class="mo">0472</span><span class="mi">8677</span><span class="n">b16f</span><span class="o">&gt;</span> <span class="ow">in</span> <span class="o">&lt;</span><span class="n">module</span><span class="o">&gt;</span>
<span class="ne">----&gt; </span><span class="mi">1</span> <span class="n">students_to_students1</span> <span class="o">=</span> <span class="n">students_to_year</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">year_to_students1</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s2">&quot;left&quot;</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="s2">&quot;Year&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="s2">&quot;Year&quot;</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="g g-Whitespace">      </span><span class="mi">2</span> <span class="n">students_to_students1</span>

<span class="ne">NameError</span>: name &#39;students_to_year&#39; is not defined
</pre></div>
</div>
</div>
</div>
<p>We can do the same composition with <code class="docutils literal notranslate"><span class="pre">year_to_students2</span></code>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">students_to_students2</span> <span class="o">=</span> <span class="n">students_to_year</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">year_to_students2</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s2">&quot;left&quot;</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="s2">&quot;Year&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="s2">&quot;Year&quot;</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">students_to_students2</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">NameError</span><span class="g g-Whitespace">                                 </span>Traceback (most recent call last)
<span class="o">&lt;</span><span class="n">ipython</span><span class="o">-</span><span class="nb">input</span><span class="o">-</span><span class="mi">15</span><span class="o">-</span><span class="n">fa56807a2d9c</span><span class="o">&gt;</span> <span class="ow">in</span> <span class="o">&lt;</span><span class="n">module</span><span class="o">&gt;</span>
<span class="ne">----&gt; </span><span class="mi">1</span> <span class="n">students_to_students2</span> <span class="o">=</span> <span class="n">students_to_year</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">year_to_students2</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s2">&quot;left&quot;</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="s2">&quot;Year&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="s2">&quot;Year&quot;</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="g g-Whitespace">      </span><span class="mi">2</span> <span class="n">students_to_students2</span>

<span class="ne">NameError</span>: name &#39;students_to_year&#39; is not defined
</pre></div>
</div>
</div>
</div>
<p>Above we perform the join on the column “Year”, and then drop the column “Year” (so that we are just left with the mapping taking <code class="docutils literal notranslate"><span class="pre">students</span></code> to <code class="docutils literal notranslate"><span class="pre">students</span></code>). We’ll see several more examples of function composition in the following sections.</p>
</div>
<div class="section" id="associativity-of-function-composition">
<h2><span class="section-number">2.4.4. </span>Associativity of function composition<a class="headerlink" href="#associativity-of-function-composition" title="Permalink to this headline">¶</a></h2>
<p>An important property of function composition is that it is <em>associative</em>, meaning that if we have functions <span class="math notranslate nohighlight">\(f,g,h\)</span>, we have that
<span class="math notranslate nohighlight">\(
h\circ(g\circ f) = (h\circ g)\circ f
\)</span>.
In words, this means that when we want to compose three functions together, we can either compute the composition of <span class="math notranslate nohighlight">\(g\)</span> and <span class="math notranslate nohighlight">\(f\)</span> first, and then compose <span class="math notranslate nohighlight">\(h\)</span> on the left, or compute the composition of <span class="math notranslate nohighlight">\(h\)</span> and <span class="math notranslate nohighlight">\(g\)</span> first, and then compose <span class="math notranslate nohighlight">\(f\)</span> on the right.
Let’s see how this works with our students dataset.</p>
<p>To do this, let’s make another function mapping <code class="docutils literal notranslate"><span class="pre">StudentID</span></code> to <code class="docutils literal notranslate"><span class="pre">Major</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">students_to_major</span> <span class="o">=</span> <span class="n">students</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;StudentID&#39;</span><span class="p">,</span> <span class="n">as_index</span><span class="o">=</span><span class="kc">False</span><span class="p">)[[</span><span class="s1">&#39;StudentID&#39;</span><span class="p">,</span><span class="s1">&#39;Major&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">first</span><span class="p">()</span>
<span class="n">students_to_major</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">NameError</span><span class="g g-Whitespace">                                 </span>Traceback (most recent call last)
<span class="o">&lt;</span><span class="n">ipython</span><span class="o">-</span><span class="nb">input</span><span class="o">-</span><span class="mi">16</span><span class="o">-</span><span class="n">ef92054ed98f</span><span class="o">&gt;</span> <span class="ow">in</span> <span class="o">&lt;</span><span class="n">module</span><span class="o">&gt;</span>
<span class="ne">----&gt; </span><span class="mi">1</span> <span class="n">students_to_major</span> <span class="o">=</span> <span class="n">students</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;StudentID&#39;</span><span class="p">,</span> <span class="n">as_index</span><span class="o">=</span><span class="bp">False</span><span class="p">)[[</span><span class="s1">&#39;StudentID&#39;</span><span class="p">,</span><span class="s1">&#39;Major&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">first</span><span class="p">()</span>
<span class="g g-Whitespace">      </span><span class="mi">2</span> <span class="n">students_to_major</span>

<span class="ne">NameError</span>: name &#39;students&#39; is not defined
</pre></div>
</div>
</div>
</div>
<p>Next, we’ll make a function which maps from <code class="docutils literal notranslate"><span class="pre">Major</span></code> to <code class="docutils literal notranslate"><span class="pre">Year</span></code>. We can do this in many ways, since there are students of many different years in each major. For this example, we’ll just pick the first <code class="docutils literal notranslate"><span class="pre">Year</span></code> after performing a group by within each major.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">major_to_year</span> <span class="o">=</span> <span class="n">students</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;Major&#39;</span><span class="p">,</span> <span class="n">as_index</span><span class="o">=</span><span class="kc">False</span><span class="p">)[[</span><span class="s1">&#39;Major&#39;</span><span class="p">,</span> <span class="s1">&#39;Year&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">first</span><span class="p">()</span>
<span class="n">major_to_year</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">NameError</span><span class="g g-Whitespace">                                 </span>Traceback (most recent call last)
<span class="o">&lt;</span><span class="n">ipython</span><span class="o">-</span><span class="nb">input</span><span class="o">-</span><span class="mi">17</span><span class="o">-</span><span class="mi">8</span><span class="n">d205654937e</span><span class="o">&gt;</span> <span class="ow">in</span> <span class="o">&lt;</span><span class="n">module</span><span class="o">&gt;</span>
<span class="ne">----&gt; </span><span class="mi">1</span> <span class="n">major_to_year</span> <span class="o">=</span> <span class="n">students</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;Major&#39;</span><span class="p">,</span> <span class="n">as_index</span><span class="o">=</span><span class="bp">False</span><span class="p">)[[</span><span class="s1">&#39;Major&#39;</span><span class="p">,</span> <span class="s1">&#39;Year&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">first</span><span class="p">()</span>
<span class="g g-Whitespace">      </span><span class="mi">2</span> <span class="n">major_to_year</span>

<span class="ne">NameError</span>: name &#39;students&#39; is not defined
</pre></div>
</div>
</div>
</div>
<p>For our last function, we’ll use the function <code class="docutils literal notranslate"><span class="pre">year_to_students1</span></code> defined in the previous section.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">year_to_students1</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">NameError</span><span class="g g-Whitespace">                                 </span>Traceback (most recent call last)
<span class="o">&lt;</span><span class="n">ipython</span><span class="o">-</span><span class="nb">input</span><span class="o">-</span><span class="mi">18</span><span class="o">-</span><span class="mi">7</span><span class="n">a0aa9e325da</span><span class="o">&gt;</span> <span class="ow">in</span> <span class="o">&lt;</span><span class="n">module</span><span class="o">&gt;</span>
<span class="ne">----&gt; </span><span class="mi">1</span> <span class="n">year_to_students1</span>

<span class="ne">NameError</span>: name &#39;year_to_students1&#39; is not defined
</pre></div>
</div>
</div>
</div>
<p>We’re going to compute the composition <code class="docutils literal notranslate"><span class="pre">year_to_students1</span></code> <span class="math notranslate nohighlight">\(\circ\)</span>(<code class="docutils literal notranslate"><span class="pre">major_to_year</span></code> <span class="math notranslate nohighlight">\(\circ\)</span> <code class="docutils literal notranslate"><span class="pre">students_to_major</span></code>) – which is a function mapping <code class="docutils literal notranslate"><span class="pre">StudentID</span></code> to <code class="docutils literal notranslate"><span class="pre">StudentID</span></code> – and show that it is equal to  (<code class="docutils literal notranslate"><span class="pre">year_to_students1</span></code> <span class="math notranslate nohighlight">\(\circ\)</span><code class="docutils literal notranslate"><span class="pre">major_to_year</span></code>) <span class="math notranslate nohighlight">\(\circ\)</span> <code class="docutils literal notranslate"><span class="pre">students_to_major</span></code>.</p>
<p>Let’s start off by computing (<code class="docutils literal notranslate"><span class="pre">major_to_year</span></code> <span class="math notranslate nohighlight">\(\circ\)</span> <code class="docutils literal notranslate"><span class="pre">students_to_major</span></code>), which we can do with a left join:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mty_comp_stm</span> <span class="o">=</span> <span class="n">major_to_year</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">students_to_major</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s2">&quot;left&quot;</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="s2">&quot;Major&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="s2">&quot;Major&quot;</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)[[</span><span class="s1">&#39;StudentID&#39;</span><span class="p">,</span> <span class="s1">&#39;Year&#39;</span><span class="p">]]</span>
<span class="n">mty_comp_stm</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">NameError</span><span class="g g-Whitespace">                                 </span>Traceback (most recent call last)
<span class="o">&lt;</span><span class="n">ipython</span><span class="o">-</span><span class="nb">input</span><span class="o">-</span><span class="mi">19</span><span class="o">-</span><span class="n">d588f95c3345</span><span class="o">&gt;</span> <span class="ow">in</span> <span class="o">&lt;</span><span class="n">module</span><span class="o">&gt;</span>
<span class="ne">----&gt; </span><span class="mi">1</span> <span class="n">mty_comp_stm</span> <span class="o">=</span> <span class="n">major_to_year</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">students_to_major</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s2">&quot;left&quot;</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="s2">&quot;Major&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="s2">&quot;Major&quot;</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)[[</span><span class="s1">&#39;StudentID&#39;</span><span class="p">,</span> <span class="s1">&#39;Year&#39;</span><span class="p">]]</span>
<span class="g g-Whitespace">      </span><span class="mi">2</span> <span class="n">mty_comp_stm</span>

<span class="ne">NameError</span>: name &#39;major_to_year&#39; is not defined
</pre></div>
</div>
</div>
</div>
<p>Notice that this gives us a function from <code class="docutils literal notranslate"><span class="pre">StudentID</span></code> to <code class="docutils literal notranslate"><span class="pre">Year</span></code>, but it is of course a different function than the function <code class="docutils literal notranslate"><span class="pre">students_to_year</span></code> we defined before. Next, we compose with <code class="docutils literal notranslate"><span class="pre">year_to_students1</span></code> on the left, to get the composition <code class="docutils literal notranslate"><span class="pre">year_to_students1</span></code> <span class="math notranslate nohighlight">\(\circ\)</span>(<code class="docutils literal notranslate"><span class="pre">major_to_year</span></code> <span class="math notranslate nohighlight">\(\circ\)</span> <code class="docutils literal notranslate"><span class="pre">students_to_major</span></code>):</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">composition1</span> <span class="o">=</span>  <span class="n">mty_comp_stm</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">year_to_students1</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s2">&quot;left&quot;</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="s2">&quot;Year&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="s2">&quot;Year&quot;</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;year_to_students1 o (major_to_year o students_to_major) is given by&#39;</span><span class="p">)</span>
<span class="n">composition1</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">NameError</span><span class="g g-Whitespace">                                 </span>Traceback (most recent call last)
<span class="o">&lt;</span><span class="n">ipython</span><span class="o">-</span><span class="nb">input</span><span class="o">-</span><span class="mi">20</span><span class="o">-</span><span class="n">fe64054148e9</span><span class="o">&gt;</span> <span class="ow">in</span> <span class="o">&lt;</span><span class="n">module</span><span class="o">&gt;</span>
<span class="ne">----&gt; </span><span class="mi">1</span> <span class="n">composition1</span> <span class="o">=</span>  <span class="n">mty_comp_stm</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">year_to_students1</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s2">&quot;left&quot;</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="s2">&quot;Year&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="s2">&quot;Year&quot;</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="g g-Whitespace">      </span><span class="mi">2</span> <span class="k">print</span><span class="p">(</span><span class="s1">&#39;year_to_students1 o (major_to_year o students_to_major) is given by&#39;</span><span class="p">)</span>
<span class="g g-Whitespace">      </span><span class="mi">3</span> <span class="n">composition1</span>

<span class="ne">NameError</span>: name &#39;mty_comp_stm&#39; is not defined
</pre></div>
</div>
</div>
</div>
<p>Next, let compute the composition the other way; namely, let’s compute (<code class="docutils literal notranslate"><span class="pre">year_to_students1</span></code> <span class="math notranslate nohighlight">\(\circ\)</span><code class="docutils literal notranslate"><span class="pre">major_to_year</span></code>) <span class="math notranslate nohighlight">\(\circ\)</span> <code class="docutils literal notranslate"><span class="pre">students_to_major</span></code>. We’ll start by computing  (<code class="docutils literal notranslate"><span class="pre">year_to_students1</span></code> <span class="math notranslate nohighlight">\(\circ\)</span><code class="docutils literal notranslate"><span class="pre">major_to_year</span></code>), which is a function from <code class="docutils literal notranslate"><span class="pre">Major</span></code> to <code class="docutils literal notranslate"><span class="pre">StudentID</span></code> :</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">yts_comp_mty</span> <span class="o">=</span> <span class="n">year_to_students1</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">major_to_year</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s2">&quot;left&quot;</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="s2">&quot;Year&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="s2">&quot;Year&quot;</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)[[</span><span class="s1">&#39;Major&#39;</span><span class="p">,</span> <span class="s1">&#39;StudentID&#39;</span><span class="p">]]</span>
<span class="n">yts_comp_mty</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">NameError</span><span class="g g-Whitespace">                                 </span>Traceback (most recent call last)
<span class="o">&lt;</span><span class="n">ipython</span><span class="o">-</span><span class="nb">input</span><span class="o">-</span><span class="mi">21</span><span class="o">-</span><span class="mi">410</span><span class="n">ec144aa27</span><span class="o">&gt;</span> <span class="ow">in</span> <span class="o">&lt;</span><span class="n">module</span><span class="o">&gt;</span>
<span class="ne">----&gt; </span><span class="mi">1</span> <span class="n">yts_comp_mty</span> <span class="o">=</span> <span class="n">year_to_students1</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">major_to_year</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s2">&quot;left&quot;</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="s2">&quot;Year&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="s2">&quot;Year&quot;</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)[[</span><span class="s1">&#39;Major&#39;</span><span class="p">,</span> <span class="s1">&#39;StudentID&#39;</span><span class="p">]]</span>
<span class="g g-Whitespace">      </span><span class="mi">2</span> <span class="n">yts_comp_mty</span>

<span class="ne">NameError</span>: name &#39;year_to_students1&#39; is not defined
</pre></div>
</div>
</div>
</div>
<p>Next, we’ll compose this with <code class="docutils literal notranslate"><span class="pre">students_to_major</span></code> on the right.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">composition2</span> <span class="o">=</span> <span class="n">students_to_major</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">yts_comp_mty</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s2">&quot;left&quot;</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="s2">&quot;Major&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="s2">&quot;Major&quot;</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;(year_to_students1 o major_to_year) o students_to_major is given by&#39;</span><span class="p">)</span>
<span class="n">composition2</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">NameError</span><span class="g g-Whitespace">                                 </span>Traceback (most recent call last)
<span class="o">&lt;</span><span class="n">ipython</span><span class="o">-</span><span class="nb">input</span><span class="o">-</span><span class="mi">22</span><span class="o">-</span><span class="n">f2d9808a9a07</span><span class="o">&gt;</span> <span class="ow">in</span> <span class="o">&lt;</span><span class="n">module</span><span class="o">&gt;</span>
<span class="ne">----&gt; </span><span class="mi">1</span> <span class="n">composition2</span> <span class="o">=</span> <span class="n">students_to_major</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">yts_comp_mty</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s2">&quot;left&quot;</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="s2">&quot;Major&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="s2">&quot;Major&quot;</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="g g-Whitespace">      </span><span class="mi">2</span> <span class="k">print</span><span class="p">(</span><span class="s1">&#39;(year_to_students1 o major_to_year) o students_to_major is given by&#39;</span><span class="p">)</span>
<span class="g g-Whitespace">      </span><span class="mi">3</span> <span class="n">composition2</span>

<span class="ne">NameError</span>: name &#39;students_to_major&#39; is not defined
</pre></div>
</div>
</div>
</div>
<p>As we can see, we do in fact have that  <code class="docutils literal notranslate"><span class="pre">year_to_students1</span></code> <span class="math notranslate nohighlight">\(\circ\)</span> (<code class="docutils literal notranslate"><span class="pre">major_to_year</span></code> <span class="math notranslate nohighlight">\(\circ\)</span> <code class="docutils literal notranslate"><span class="pre">students_to_major</span></code>) =  (<code class="docutils literal notranslate"><span class="pre">year_to_students1</span></code> <span class="math notranslate nohighlight">\(\circ\)</span><code class="docutils literal notranslate"><span class="pre">major_to_year</span></code>) <span class="math notranslate nohighlight">\(\circ\)</span> <code class="docutils literal notranslate"><span class="pre">students_to_major</span></code> – that is, we’ve shown the associative property!</p>
</div>
<div class="section" id="function-compositions-yield-the-identity">
<h2><span class="section-number">2.4.5. </span>Function compositions yield the Identity<a class="headerlink" href="#function-compositions-yield-the-identity" title="Permalink to this headline">¶</a></h2>
<p>In the previous two section, we composed functions and obtained new function mapping the set <code class="docutils literal notranslate"><span class="pre">StudentID</span></code> to itself.
However, none of these compositions gave us the <em>identity function</em> on the set <code class="docutils literal notranslate"><span class="pre">StudentID</span></code> – namely, each student ID was not mapped to itself.
It is, however, very easy to compose two functions and obtain the identity function.
In this section, we give a few examples of such a composition.</p>
<p>First, let’s consider the function <code class="docutils literal notranslate"><span class="pre">students_to_major</span></code> which we’ve used in the previous sections.
Is there a function that we compose on the right to obtain the identity?
Let’s try and find one.
Below, we define a function<code class="docutils literal notranslate"><span class="pre">major_to_students</span></code>, which assigns to each major the student with the smallest student ID.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">major_to_students</span> <span class="o">=</span> <span class="n">students</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;Major&#39;</span><span class="p">,</span> <span class="n">as_index</span><span class="o">=</span><span class="kc">False</span><span class="p">)[[</span><span class="s1">&#39;Major&#39;</span><span class="p">,</span><span class="s1">&#39;StudentID&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="s1">&#39;StudentID&#39;</span><span class="p">)</span>
<span class="n">major_to_students</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">NameError</span><span class="g g-Whitespace">                                 </span>Traceback (most recent call last)
<span class="o">&lt;</span><span class="n">ipython</span><span class="o">-</span><span class="nb">input</span><span class="o">-</span><span class="mi">23</span><span class="o">-</span><span class="mi">1</span><span class="n">f744e103e25</span><span class="o">&gt;</span> <span class="ow">in</span> <span class="o">&lt;</span><span class="n">module</span><span class="o">&gt;</span>
<span class="ne">----&gt; </span><span class="mi">1</span> <span class="n">major_to_students</span> <span class="o">=</span> <span class="n">students</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;Major&#39;</span><span class="p">,</span> <span class="n">as_index</span><span class="o">=</span><span class="bp">False</span><span class="p">)[[</span><span class="s1">&#39;Major&#39;</span><span class="p">,</span><span class="s1">&#39;StudentID&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="s1">&#39;StudentID&#39;</span><span class="p">)</span>
<span class="g g-Whitespace">      </span><span class="mi">2</span> <span class="n">major_to_students</span>

<span class="ne">NameError</span>: name &#39;students&#39; is not defined
</pre></div>
</div>
</div>
</div>
<p>Now, what happens if we compose these to get a function <code class="docutils literal notranslate"><span class="pre">students_to_major</span></code> <span class="math notranslate nohighlight">\(\circ\)</span> <code class="docutils literal notranslate"><span class="pre">major_to_students</span></code>, from <code class="docutils literal notranslate"><span class="pre">Major</span></code> to <code class="docutils literal notranslate"><span class="pre">Major</span></code>?
Let’s see:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">major_to_major</span> <span class="o">=</span> <span class="n">major_to_students</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">students_to_major</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s2">&quot;left&quot;</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="s2">&quot;StudentID&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="s2">&quot;StudentID&quot;</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">major_to_major</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">NameError</span><span class="g g-Whitespace">                                 </span>Traceback (most recent call last)
<span class="o">&lt;</span><span class="n">ipython</span><span class="o">-</span><span class="nb">input</span><span class="o">-</span><span class="mi">24</span><span class="o">-</span><span class="mi">99</span><span class="n">d5ef62a3b8</span><span class="o">&gt;</span> <span class="ow">in</span> <span class="o">&lt;</span><span class="n">module</span><span class="o">&gt;</span>
<span class="ne">----&gt; </span><span class="mi">1</span> <span class="n">major_to_major</span> <span class="o">=</span> <span class="n">major_to_students</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">students_to_major</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s2">&quot;left&quot;</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="s2">&quot;StudentID&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="s2">&quot;StudentID&quot;</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="g g-Whitespace">      </span><span class="mi">2</span> <span class="n">major_to_major</span>

<span class="ne">NameError</span>: name &#39;major_to_students&#39; is not defined
</pre></div>
</div>
</div>
</div>
<p>This time we do indeed get the identity function on the set <code class="docutils literal notranslate"><span class="pre">Major</span></code>!</p>
<p>What happens if we try to “reverse” the operation, and instead compute the composition <code class="docutils literal notranslate"><span class="pre">major_to_students</span></code> <span class="math notranslate nohighlight">\(\circ\)</span> <code class="docutils literal notranslate"><span class="pre">students_to_major</span></code>, which this time is a function between <code class="docutils literal notranslate"><span class="pre">StudentID</span></code> and <code class="docutils literal notranslate"><span class="pre">StudentID</span></code>?</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">students_to_students2</span> <span class="o">=</span> <span class="n">students_to_major</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">major_to_students</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s2">&quot;left&quot;</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="s2">&quot;Major&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="s2">&quot;Major&quot;</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">students_to_students2</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">NameError</span><span class="g g-Whitespace">                                 </span>Traceback (most recent call last)
<span class="o">&lt;</span><span class="n">ipython</span><span class="o">-</span><span class="nb">input</span><span class="o">-</span><span class="mi">25</span><span class="o">-</span><span class="mi">8163</span><span class="n">d6ccf125</span><span class="o">&gt;</span> <span class="ow">in</span> <span class="o">&lt;</span><span class="n">module</span><span class="o">&gt;</span>
<span class="ne">----&gt; </span><span class="mi">1</span> <span class="n">students_to_students2</span> <span class="o">=</span> <span class="n">students_to_major</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">major_to_students</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s2">&quot;left&quot;</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="s2">&quot;Major&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="s2">&quot;Major&quot;</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="g g-Whitespace">      </span><span class="mi">2</span> <span class="n">students_to_students2</span>

<span class="ne">NameError</span>: name &#39;students_to_major&#39; is not defined
</pre></div>
</div>
</div>
</div>
<p>This is distinctly <em>not</em> the identity function.
So, we can compose in one direction and get the identity, but not the other.
As we will see later, this is related to the fact that the set <code class="docutils literal notranslate"><span class="pre">Major</span></code> is “smaller” than the set <code class="docutils literal notranslate"><span class="pre">StudentID</span></code>.</p>
<p>Here is another example, where we <em>can</em> get the identity function on students.
Let’s consider the function <code class="docutils literal notranslate"><span class="pre">students_to_grades</span></code> that we defined above, which maps students to their highest grade.
Next, let’s define a function <code class="docutils literal notranslate"><span class="pre">grades_to_students</span></code> which maps grades to students.
This is not necessarily a well-defined function in all cases, since multiple students could have the same grade. However, we can do this in this case by simply flipping the columns of the <code class="docutils literal notranslate"><span class="pre">students_to_grades</span></code> table:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">grades_to_students</span> <span class="o">=</span> <span class="n">students_to_grades</span><span class="p">[[</span><span class="s1">&#39;Grade&#39;</span><span class="p">,</span> <span class="s1">&#39;StudentID&#39;</span><span class="p">]]</span>
<span class="n">grades_to_students</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">NameError</span><span class="g g-Whitespace">                                 </span>Traceback (most recent call last)
<span class="o">&lt;</span><span class="n">ipython</span><span class="o">-</span><span class="nb">input</span><span class="o">-</span><span class="mi">26</span><span class="o">-</span><span class="mi">21</span><span class="n">cdab48ffeb</span><span class="o">&gt;</span> <span class="ow">in</span> <span class="o">&lt;</span><span class="n">module</span><span class="o">&gt;</span>
<span class="ne">----&gt; </span><span class="mi">1</span> <span class="n">grades_to_students</span> <span class="o">=</span> <span class="n">students_to_grades</span><span class="p">[[</span><span class="s1">&#39;Grade&#39;</span><span class="p">,</span> <span class="s1">&#39;StudentID&#39;</span><span class="p">]]</span>
<span class="g g-Whitespace">      </span><span class="mi">2</span> <span class="n">grades_to_students</span>

<span class="ne">NameError</span>: name &#39;students_to_grades&#39; is not defined
</pre></div>
</div>
</div>
</div>
<p>Now, let’s compose these function to get <code class="docutils literal notranslate"><span class="pre">grades_to_students</span></code> <span class="math notranslate nohighlight">\(\circ\)</span> <code class="docutils literal notranslate"><span class="pre">students_to_grades</span></code>, and see if it gives us the identity function on <code class="docutils literal notranslate"><span class="pre">StudentID</span></code>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">students_to_students3</span> <span class="o">=</span> <span class="n">students_to_grades</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">grades_to_students</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s2">&quot;left&quot;</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="s2">&quot;Grade&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="s2">&quot;Grade&quot;</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">students_to_students3</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">NameError</span><span class="g g-Whitespace">                                 </span>Traceback (most recent call last)
<span class="o">&lt;</span><span class="n">ipython</span><span class="o">-</span><span class="nb">input</span><span class="o">-</span><span class="mi">27</span><span class="o">-</span><span class="n">ee0694252fd2</span><span class="o">&gt;</span> <span class="ow">in</span> <span class="o">&lt;</span><span class="n">module</span><span class="o">&gt;</span>
<span class="ne">----&gt; </span><span class="mi">1</span> <span class="n">students_to_students3</span> <span class="o">=</span> <span class="n">students_to_grades</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">grades_to_students</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s2">&quot;left&quot;</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="s2">&quot;Grade&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="s2">&quot;Grade&quot;</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="g g-Whitespace">      </span><span class="mi">2</span> <span class="n">students_to_students3</span>

<span class="ne">NameError</span>: name &#39;students_to_grades&#39; is not defined
</pre></div>
</div>
</div>
</div>
<p>Finally, this gave us an identity function on <code class="docutils literal notranslate"><span class="pre">StudentID</span></code>!
However, we should be entirely surprised by this: indeed, this worked because each student happened to have a <em>unique</em> highest grade, which meant this grade could be uniquely assigned to each student, and thus we can translate between grades and students without losing any information.
We can see this is true by flipping the composition in the other direction, and looking at the function <code class="docutils literal notranslate"><span class="pre">students_to_grades</span></code> <span class="math notranslate nohighlight">\(\circ\)</span> <code class="docutils literal notranslate"><span class="pre">grades_to_students</span></code>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">grades_to_grades</span> <span class="o">=</span> <span class="n">students_to_grades</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">grades_to_students</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s2">&quot;left&quot;</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="s2">&quot;StudentID&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="s2">&quot;StudentID&quot;</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">grades_to_grades</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">NameError</span><span class="g g-Whitespace">                                 </span>Traceback (most recent call last)
<span class="o">&lt;</span><span class="n">ipython</span><span class="o">-</span><span class="nb">input</span><span class="o">-</span><span class="mi">28</span><span class="o">-</span><span class="n">dda858d8df76</span><span class="o">&gt;</span> <span class="ow">in</span> <span class="o">&lt;</span><span class="n">module</span><span class="o">&gt;</span>
<span class="ne">----&gt; </span><span class="mi">1</span> <span class="n">grades_to_grades</span> <span class="o">=</span> <span class="n">students_to_grades</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">grades_to_students</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s2">&quot;left&quot;</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="s2">&quot;StudentID&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="s2">&quot;StudentID&quot;</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="g g-Whitespace">      </span><span class="mi">2</span> <span class="n">grades_to_grades</span>

<span class="ne">NameError</span>: name &#39;students_to_grades&#39; is not defined
</pre></div>
</div>
</div>
</div>
<p>Indeed, this gives us the identity on (a subset of) the set <code class="docutils literal notranslate"><span class="pre">Grade</span></code>.
Which subset in particular is this?
It is simply <em>range</em> of our function <code class="docutils literal notranslate"><span class="pre">students_to_grades</span></code>.</p>
</div>
<div class="section" id="idempotent-projection-functions">
<h2><span class="section-number">2.4.6. </span>Idempotent/projection functions<a class="headerlink" href="#idempotent-projection-functions" title="Permalink to this headline">¶</a></h2>
<p>An idempotent function, also known as a projection function, is a function that yields the same answer when it is applied twice as when it is applied once.
In other words, a function <span class="math notranslate nohighlight">\(f:A\to A\)</span> is <em>idempotent</em> if for all <span class="math notranslate nohighlight">\(a\in A\)</span>, <span class="math notranslate nohighlight">\(f(a) = f(f(a))\)</span>.</p>
<p>We can illustrate it with basic set operations (as last time, with set union and intersection), and we can illustrate it with more general functions with a data frame.</p>
<p>Let’s see a simple example.
Consider the function <span class="math notranslate nohighlight">\(f\)</span> mapping <code class="docutils literal notranslate"><span class="pre">StudentID</span></code> to <code class="docutils literal notranslate"><span class="pre">StudentID</span></code>, defined in the following way.
For each student, the function <span class="math notranslate nohighlight">\(f\)</span> returns the student in his/her major with the highest average grade.
Let’s compute this function using python.
First, we define a new data frame with each student’s average grades:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">students_avg_grades</span> <span class="o">=</span> <span class="n">students</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s2">&quot;StudentID&quot;</span><span class="p">,</span> <span class="n">as_index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="s1">&#39;Grade&#39;</span><span class="p">)</span>
<span class="n">majors</span> <span class="o">=</span> <span class="n">students</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s2">&quot;StudentID&quot;</span><span class="p">,</span> <span class="n">as_index</span><span class="o">=</span><span class="kc">False</span><span class="p">)[[</span><span class="s1">&#39;StudentID&#39;</span><span class="p">,</span> <span class="s1">&#39;Major&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">first</span><span class="p">()</span>
<span class="n">students_avg_grades</span><span class="p">[</span><span class="s1">&#39;Major&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">majors</span><span class="p">[</span><span class="s1">&#39;Major&#39;</span><span class="p">]</span>
<span class="n">students_avg_grades</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">NameError</span><span class="g g-Whitespace">                                 </span>Traceback (most recent call last)
<span class="o">&lt;</span><span class="n">ipython</span><span class="o">-</span><span class="nb">input</span><span class="o">-</span><span class="mi">29</span><span class="o">-</span><span class="n">e903885f2c01</span><span class="o">&gt;</span> <span class="ow">in</span> <span class="o">&lt;</span><span class="n">module</span><span class="o">&gt;</span>
<span class="ne">----&gt; </span><span class="mi">1</span> <span class="n">students_avg_grades</span> <span class="o">=</span> <span class="n">students</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s2">&quot;StudentID&quot;</span><span class="p">,</span> <span class="n">as_index</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="s1">&#39;Grade&#39;</span><span class="p">)</span>
<span class="g g-Whitespace">      </span><span class="mi">2</span> <span class="n">majors</span> <span class="o">=</span> <span class="n">students</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s2">&quot;StudentID&quot;</span><span class="p">,</span> <span class="n">as_index</span><span class="o">=</span><span class="bp">False</span><span class="p">)[[</span><span class="s1">&#39;StudentID&#39;</span><span class="p">,</span> <span class="s1">&#39;Major&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">first</span><span class="p">()</span>
<span class="g g-Whitespace">      </span><span class="mi">3</span> <span class="n">students_avg_grades</span><span class="p">[</span><span class="s1">&#39;Major&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">majors</span><span class="p">[</span><span class="s1">&#39;Major&#39;</span><span class="p">]</span>
<span class="g g-Whitespace">      </span><span class="mi">4</span> <span class="n">students_avg_grades</span>

<span class="ne">NameError</span>: name &#39;students&#39; is not defined
</pre></div>
</div>
</div>
</div>
<p>Next, we can compute the function <span class="math notranslate nohighlight">\(f\)</span> from  <code class="docutils literal notranslate"><span class="pre">StudentID</span></code> to <code class="docutils literal notranslate"><span class="pre">StudentID</span></code> defined above.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">max_grade_by_major</span> <span class="o">=</span> <span class="n">students_avg_grades</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s2">&quot;Major&quot;</span><span class="p">,</span> <span class="n">as_index</span><span class="o">=</span><span class="kc">False</span><span class="p">)[[</span><span class="s2">&quot;Major&quot;</span><span class="p">,</span> <span class="s2">&quot;StudentID&quot;</span><span class="p">]]</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="s2">&quot;Grade&quot;</span><span class="p">)</span>
<span class="n">stdnt_to_stdnt_highest_grade</span> <span class="o">=</span> <span class="n">students_avg_grades</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">max_grade_by_major</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s2">&quot;left&quot;</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="s2">&quot;Major&quot;</span><span class="p">)[[</span><span class="s1">&#39;StudentID_x&#39;</span><span class="p">,</span> <span class="s1">&#39;StudentID_y&#39;</span><span class="p">,</span> <span class="s1">&#39;Major&#39;</span><span class="p">]]</span>
<span class="n">stdnt_to_stdnt_highest_grade</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;StudentID&#39;</span><span class="p">,</span> <span class="s1">&#39;f(StudentID)&#39;</span><span class="p">,</span> <span class="s1">&#39;Major&#39;</span><span class="p">]</span>
<span class="n">stdnt_to_stdnt_highest_grade</span><span class="p">[[</span><span class="s1">&#39;StudentID&#39;</span><span class="p">,</span> <span class="s1">&#39;f(StudentID)&#39;</span><span class="p">]]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">NameError</span><span class="g g-Whitespace">                                 </span>Traceback (most recent call last)
<span class="o">&lt;</span><span class="n">ipython</span><span class="o">-</span><span class="nb">input</span><span class="o">-</span><span class="mi">30</span><span class="o">-</span><span class="mi">5</span><span class="n">ea990c115a5</span><span class="o">&gt;</span> <span class="ow">in</span> <span class="o">&lt;</span><span class="n">module</span><span class="o">&gt;</span>
<span class="ne">----&gt; </span><span class="mi">1</span> <span class="n">max_grade_by_major</span> <span class="o">=</span> <span class="n">students_avg_grades</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s2">&quot;Major&quot;</span><span class="p">,</span> <span class="n">as_index</span><span class="o">=</span><span class="bp">False</span><span class="p">)[[</span><span class="s2">&quot;Major&quot;</span><span class="p">,</span> <span class="s2">&quot;StudentID&quot;</span><span class="p">]]</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="s2">&quot;Grade&quot;</span><span class="p">)</span>
<span class="g g-Whitespace">      </span><span class="mi">2</span> <span class="n">stdnt_to_stdnt_highest_grade</span> <span class="o">=</span> <span class="n">students_avg_grades</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">max_grade_by_major</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s2">&quot;left&quot;</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="s2">&quot;Major&quot;</span><span class="p">)[[</span><span class="s1">&#39;StudentID_x&#39;</span><span class="p">,</span> <span class="s1">&#39;StudentID_y&#39;</span><span class="p">,</span> <span class="s1">&#39;Major&#39;</span><span class="p">]]</span>
<span class="g g-Whitespace">      </span><span class="mi">3</span> <span class="n">stdnt_to_stdnt_highest_grade</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;StudentID&#39;</span><span class="p">,</span> <span class="s1">&#39;f(StudentID)&#39;</span><span class="p">,</span> <span class="s1">&#39;Major&#39;</span><span class="p">]</span>
<span class="g g-Whitespace">      </span><span class="mi">4</span> <span class="n">stdnt_to_stdnt_highest_grade</span><span class="p">[[</span><span class="s1">&#39;StudentID&#39;</span><span class="p">,</span> <span class="s1">&#39;f(StudentID)&#39;</span><span class="p">]]</span>

<span class="ne">NameError</span>: name &#39;students_avg_grades&#39; is not defined
</pre></div>
</div>
</div>
</div>
<p>Note that we did a bit of clean up in the cell above to make sure that the column names were interpretable (Pandas will automatically assign new column names when we join two tables with the same column name).</p>
<p>Now, let’s use another join to compute <span class="math notranslate nohighlight">\(f(f(\text{StudentID}))\)</span>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">stdnt_to_stdnt_highest_grade2</span> <span class="o">=</span> <span class="n">stdnt_to_stdnt_highest_grade</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">max_grade_by_major</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s2">&quot;left&quot;</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="s2">&quot;Major&quot;</span><span class="p">)[[</span><span class="s1">&#39;StudentID_x&#39;</span><span class="p">,</span> <span class="s1">&#39;f(StudentID)&#39;</span><span class="p">,</span> <span class="s1">&#39;StudentID_y&#39;</span><span class="p">]]</span>
<span class="n">stdnt_to_stdnt_highest_grade2</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;StudentID&#39;</span><span class="p">,</span> <span class="s1">&#39;f(StudentID)&#39;</span><span class="p">,</span> <span class="s1">&#39;f(f(StudentID))&#39;</span><span class="p">]</span>
<span class="n">stdnt_to_stdnt_highest_grade2</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">NameError</span><span class="g g-Whitespace">                                 </span>Traceback (most recent call last)
<span class="o">&lt;</span><span class="n">ipython</span><span class="o">-</span><span class="nb">input</span><span class="o">-</span><span class="mi">31</span><span class="o">-</span><span class="mi">340198</span><span class="n">a6201e</span><span class="o">&gt;</span> <span class="ow">in</span> <span class="o">&lt;</span><span class="n">module</span><span class="o">&gt;</span>
<span class="ne">----&gt; </span><span class="mi">1</span> <span class="n">stdnt_to_stdnt_highest_grade2</span> <span class="o">=</span> <span class="n">stdnt_to_stdnt_highest_grade</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">max_grade_by_major</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s2">&quot;left&quot;</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="s2">&quot;Major&quot;</span><span class="p">)[[</span><span class="s1">&#39;StudentID_x&#39;</span><span class="p">,</span> <span class="s1">&#39;f(StudentID)&#39;</span><span class="p">,</span> <span class="s1">&#39;StudentID_y&#39;</span><span class="p">]]</span>
<span class="g g-Whitespace">      </span><span class="mi">2</span> <span class="n">stdnt_to_stdnt_highest_grade2</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;StudentID&#39;</span><span class="p">,</span> <span class="s1">&#39;f(StudentID)&#39;</span><span class="p">,</span> <span class="s1">&#39;f(f(StudentID))&#39;</span><span class="p">]</span>
<span class="g g-Whitespace">      </span><span class="mi">3</span> <span class="n">stdnt_to_stdnt_highest_grade2</span>

<span class="ne">NameError</span>: name &#39;stdnt_to_stdnt_highest_grade&#39; is not defined
</pre></div>
</div>
</div>
</div>
<p>Indeed, we see that the columns <code class="docutils literal notranslate"><span class="pre">f(StudentID)</span></code> and <code class="docutils literal notranslate"><span class="pre">f(f(StudentID))</span></code> are equal, and so the function <span class="math notranslate nohighlight">\(f\)</span> is in fact idempotent.</p>
<p>An interesting property of idempotent function is that they are always equal to the identity function on their image.
This make sense:  if <span class="math notranslate nohighlight">\(b \in \text{Image}(f)\)</span>, then <span class="math notranslate nohighlight">\(b = f(a)\)</span> for some <span class="math notranslate nohighlight">\(a\in A\)</span>, and thus <span class="math notranslate nohighlight">\(b = f(a) = f(f(a)) = f(b)\)</span>.
Let’s verify this with code, by restricting the function <span class="math notranslate nohighlight">\(f\)</span> to its image.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">stdnt_to_stdnt_highest_grade</span><span class="p">[</span><span class="n">stdnt_to_stdnt_highest_grade</span><span class="p">[</span><span class="s1">&#39;StudentID&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">stdnt_to_stdnt_highest_grade</span><span class="p">[</span><span class="s1">&#39;f(StudentID)&#39;</span><span class="p">])][[</span><span class="s1">&#39;StudentID&#39;</span><span class="p">,</span> <span class="s1">&#39;f(StudentID)&#39;</span><span class="p">]]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">NameError</span><span class="g g-Whitespace">                                 </span>Traceback (most recent call last)
<span class="o">&lt;</span><span class="n">ipython</span><span class="o">-</span><span class="nb">input</span><span class="o">-</span><span class="mi">32</span><span class="o">-</span><span class="mi">95068</span><span class="n">c65e1db</span><span class="o">&gt;</span> <span class="ow">in</span> <span class="o">&lt;</span><span class="n">module</span><span class="o">&gt;</span>
<span class="ne">----&gt; </span><span class="mi">1</span> <span class="n">stdnt_to_stdnt_highest_grade</span><span class="p">[</span><span class="n">stdnt_to_stdnt_highest_grade</span><span class="p">[</span><span class="s1">&#39;StudentID&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">stdnt_to_stdnt_highest_grade</span><span class="p">[</span><span class="s1">&#39;f(StudentID)&#39;</span><span class="p">])][[</span><span class="s1">&#39;StudentID&#39;</span><span class="p">,</span> <span class="s1">&#39;f(StudentID)&#39;</span><span class="p">]]</span>

<span class="ne">NameError</span>: name &#39;stdnt_to_stdnt_highest_grade&#39; is not defined
</pre></div>
</div>
</div>
</div>
<p>As expected, when we restrict <span class="math notranslate nohighlight">\(f\)</span> to <span class="math notranslate nohighlight">\(\text{Image}(f)\)</span> we do indeed get the identity function back.</p>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./10_Overview"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
        </div>
    </div>
    
    
    <div class='prev-next-bottom'>
        
    <a class='left-prev' id="prev-link" href="hw01.html" title="previous page"><span class="section-number">2.3. </span>Homework 1</a>
    <a class='right-next' id="next-link" href="hw02.html" title="next page"><span class="section-number">2.5. </span>Homework 2</a>

    </div>
    <footer class="footer mt-5 mt-md-0">
    <div class="container">
      <p>
        
          By Michael W. Mahoney, N. Benjamin Erichson and Ryan Theisen<br/>
        
            &copy; Copyright 2021.<br/>
      </p>
    </div>
  </footer>
</main>


      </div>
    </div>

    
  <script src="../_static/js/index.d3f166471bb80abb5163.js"></script>


    
  </body>
</html>